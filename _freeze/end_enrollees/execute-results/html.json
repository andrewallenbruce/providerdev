{
  "hash": "26b495556a86455ff7c917795659ad8f",
  "result": {
    "engine": "knitr",
    "markdown": "# `enrollees` {#sec-enrollees}\n\n\n\n   * Base URL: `https://data.cms.gov/data-api/v1/`\n   * Identifier: `2457ea29-fc82-48b0-86ec-3b0755de7515`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nperform_request <- \\(request, query, limit) {\n  \n  req <- req_url_query(\n    request, \n    !!!format_query(query), \n    size = limit)\n  \n  n <- req_url_path_append(req, \"stats\") |>\n    req_perform() |>\n    resp_body_json(simplifyVector = TRUE) |>\n    getelem(\"found_rows\")\n  \n  if (n == 0) {\n    rlang::abort(\n    message = c(\"!\" = glue::glue(\"{n} results found.\")),\n    use_cli_format = TRUE,\n    call = rlang::caller_env(),\n    class = \"abort_no_results\"\n  )\n    }\n  \n  off_len <- length(offset_sequence(n = n, limit = limit))\n  \n  if (off_len == 1) {\n    return(\n      qTBL(\n        fparse(\n          resp_body_string(\n            req_perform(req))) |> \n          _[[\"data\"]]) |> \n      set_names(names(query)) |> \n      providertwo:::map_na_if()\n    )\n  }\n  \n  if (off_len > 1) {\n    return(\n      req_perform_iterative(\n      req,\n      next_req        = iterate_with_offset(\n        param_name    = \"offset\",\n        start         = 0,\n        offset        = limit,\n        resp_complete = providertwo:::is_complete_with_limit(limit))) |> \n      map(\\(x) qTBL(fparse(resp_body_string(x)) |> _[[\"data\"]])) |>\n      rowbind() |>\n    set_names(names(query)) |> \n      providertwo:::map_na_if()\n    )\n  }\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nenrollees2 <- function(npi       = NULL,\n                       pac       = NULL,\n                       enid      = NULL,\n                       spec_code = NULL,\n                       spec_desc = NULL,\n                       first     = NULL,\n                       middle    = NULL,\n                       last      = NULL,\n                       org       = NULL,\n                       state     = NULL,\n                       gender    = NULL,\n                       limit     = 5000) {\n\n  providertwo:::check_number_whole(limit, min = 0)\n\n  args <- list2(\n    \"NPI\"                = npi,\n    \"PECOS_ASCT_CNTL_ID\" = pac,\n    \"ENRLMT_ID\"          = enid,\n    \"PROVIDER_TYPE_CD\"   = spec_code,\n    \"PROVIDER_TYPE_DESC\" = spec_desc,\n    \"STATE_CD\"           = state,\n    \"FIRST_NAME\"         = first,\n    \"MDL_NAME\"           = middle,\n    \"LAST_NAME\"          = last,\n    \"ORG_NAME\"           = org,\n    \"GNDR_SW\"            = gender)\n\n  api <- public_Dataset(\"Public Provider Enrollment\")\n  \n  perform_request(\n    request = api@identifier@request, \n    query   = args, \n    limit   = limit)\n}\n```\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nenrollees2(enid = \"I2004030900022\")\n```\n\n::: {.cell-output .cell-output-error}\n\n```\nError in `enrollees2()`:\n! 0 results found.\n```\n\n\n:::\n\n```{.r .cell-code}\nenrollees2(npi = \"1417918293\", spec_code = \"14-41\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 11\n  NPI        PECOS_ASCT_CNTL_ID ENRLMT_ID    PROVIDER_TYPE_CD PROVIDER_TYPE_DESC\n  <chr>      <chr>              <chr>        <chr>            <chr>             \n1 1417918293 3870481252         I2004030900… 14-41            PRACTITIONER - OP…\n# ℹ 6 more variables: STATE_CD <chr>, FIRST_NAME <chr>, MDL_NAME <chr>,\n#   LAST_NAME <chr>, ORG_NAME <chr>, GNDR_SW <chr>\n```\n\n\n:::\n\n```{.r .cell-code}\nenrollees2(pac = \"2860305554\", gender = \"9\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 11\n  NPI        PECOS_ASCT_CNTL_ID ENRLMT_ID    PROVIDER_TYPE_CD PROVIDER_TYPE_DESC\n  <chr>      <chr>              <chr>        <chr>            <chr>             \n1 1134122260 2860305554         I2003111000… 14-41            PRACTITIONER - OP…\n# ℹ 6 more variables: STATE_CD <chr>, FIRST_NAME <chr>, MDL_NAME <chr>,\n#   LAST_NAME <chr>, ORG_NAME <chr>, GNDR_SW <chr>\n```\n\n\n:::\n\n```{.r .cell-code}\nenrollees2(state = \"GA\", gender = \"9\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 121 × 11\n   NPI        PECOS_ASCT_CNTL_ID ENRLMT_ID   PROVIDER_TYPE_CD PROVIDER_TYPE_DESC\n   <chr>      <chr>              <chr>       <chr>            <chr>             \n 1 1508822776 3476457953         I200311250… 14-77            PRACTITIONER - VA…\n 2 1619914975 1557264553         I200401280… 14-11            PRACTITIONER - IN…\n 3 1285670901 7012807977         I200403160… 14-11            PRACTITIONER - IN…\n 4 1841207917 1456343961         I200404020… 14-02            PRACTITIONER - GE…\n 5 1942275425 1658364039         I200404050… 14-93            PRACTITIONER - EM…\n 6 1275645459 4789677840         I200404050… 14-38            PRACTITIONER - GE…\n 7 1073608899 9638164619         I200404190… 14-66            PRACTITIONER - RH…\n 8 1124147343 1850388026         I200404290… 14-65            PRACTITIONER - PH…\n 9 1336246149 7911996392         I200405110… 14-16            PRACTITIONER - OB…\n10 1891773792 7113917816         I200405140… 14-50            PRACTITIONER - NU…\n# ℹ 111 more rows\n# ℹ 6 more variables: STATE_CD <chr>, FIRST_NAME <chr>, MDL_NAME <chr>,\n#   LAST_NAME <chr>, ORG_NAME <chr>, GNDR_SW <chr>\n```\n\n\n:::\n\n```{.r .cell-code}\nenrollees2(state = \"GA\", gender = \"F\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 29,249 × 11\n   NPI        PECOS_ASCT_CNTL_ID ENRLMT_ID   PROVIDER_TYPE_CD PROVIDER_TYPE_DESC\n   <chr>      <chr>              <chr>       <chr>            <chr>             \n 1 1245249333 9931011665         I200311030… 14-08            PRACTITIONER - FA…\n 2 1508866765 8022920578         I200311040… 14-48            PRACTITIONER - PO…\n 3 1295784429 1759294671         I200311070… 14-14            PRACTITIONER - NE…\n 4 1861594822 4880507706         I200311070… 14-43            PRACTITIONER - CE…\n 5 1235174855 1254244023         I200311070… 14-97            PRACTITIONER - PH…\n 6 1023003993 0446163240         I200311070… 14-11            PRACTITIONER - IN…\n 7 1407845340 8820901523         I200311100… 14-11            PRACTITIONER - IN…\n 8 1831234335 7719890359         I200311100… 14-35            PRACTITIONER - CH…\n 9 1699710442 6608789292         I200311100… 14-11            PRACTITIONER - IN…\n10 1912975889 2365355740         I200311110… 14-08            PRACTITIONER - FA…\n# ℹ 29,239 more rows\n# ℹ 6 more variables: STATE_CD <chr>, FIRST_NAME <chr>, MDL_NAME <chr>,\n#   LAST_NAME <chr>, ORG_NAME <chr>, GNDR_SW <chr>\n```\n\n\n:::\n:::\n\n\n## Catalog\n\n::: {.cell}\n\n```{.r .cell-code}\npublic_catalog <- \\() {\n  \n  x <- RcppSimdJson::fload(\"https://data.cms.gov/data.json\")\n  \n  collapse::qTBL(x[[\"dataset\"]]) |>\n    collapse::fmutate(\n      bureauCode   = delist(bureauCode),\n      language     = delist(language),\n      programCode  = delist(programCode),\n      references   = delist(references),\n      theme        = flatten_column(theme),\n      keyword      = flatten_column(keyword)) |>\n    collapse::frename(remove_at_symbol)\n}\n\npublic <- public_catalog()\n\npublic\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 139 × 22\n   type       accessLevel accrualPeriodicity bureauCode contactPoint describedBy\n   <chr>      <chr>       <chr>              <chr>      <list>       <chr>      \n 1 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 2 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 3 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 4 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 5 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 6 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 7 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 8 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 9 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n10 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n# ℹ 129 more rows\n# ℹ 16 more variables: dataQuality <lgl>, description <chr>,\n#   distribution <list>, identifier <chr>, keyword <chr>, landingPage <chr>,\n#   language <chr>, license <chr>, modified <chr>, programCode <chr>,\n#   publisher <list>, references <chr>, temporal <chr>, theme <chr>,\n#   title <chr>, describedByType <chr>\n```\n\n\n:::\n:::\n\n## Dataset\n\n::: {.cell}\n\n```{.r .cell-code}\ndataset <- \\(catalog, search) {\n  collapse::fsubset(\n    catalog, \n    providertwo::sf_detect(\n      title, \n      search\n      )\n    )\n}\n\nffs <- dataset(public, \"Fee-For-Service\")\n\nffs |> purse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- $type               c1  dcat:Dataset                                      ...\n- $accessLevel        c1  public                                            ...\n- $accrualPeriodicity c1  R/P3M                                             ...\n- $bureauCode         c1  009:38                                            ...\n- $contactPoint       L1  list(list(\"@type\" = \"vcard:Contact\", fn = \"Provid ...\n- $describedBy        c1  https://data.cms.gov/resources/medicare-fee-for-s ...\n- $dataQuality        l1  T                                                 ...\n- $description        c1  The Medicare Fee-For-Service Public Provider Enro ...\n- $distribution       L1  list(structure(list(\"@type\" = c(\"dcat:Distributio ...\n- $identifier         c1  https://data.cms.gov/data-api/v1/dataset/2457ea29 ...\n- $keyword            c1  Medicare, Original Medicare, Provider Enrollment  ...\n- $landingPage        c1  https://data.cms.gov/provider-characteristics/med ...\n- $language           c1  en-US                                             ...\n- $license            c1  https://www.usa.gov/government-works              ...\n- $modified           c1  2025-01-15                                        ...\n- $programCode        c1  009:000                                           ...\n- $publisher          L1  list(list(\"@type\" = \"org:Organization\", name = \"C ...\n- $references         c1  https://data.cms.gov/resources/fee-for-service-pu ...\n- $temporal           c1  2023-01-01/2024-12-31                             ...\n- $theme              c1  Medicare                                          ...\n- $title              c1  Medicare Fee-For-Service  Public Provider Enrollm ...\n- $describedByType    c1  NA                                                ...\n```\n\n\n:::\n:::\n\n\n## Distribution\n\n::: {.cell}\n\n```{.r .cell-code}\ndistribution <- \\(dataset, search) {\n  \n  x <- collapse::fsubset(\n    dataset[c(\"title\", \"distribution\")], \n    providertwo::sf_detect(title, search))\n  \n  collapse::qTBL(x[[\"distribution\"]][[1]])\n}\n\ndistribution(ffs, \"Fee-For-Service\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 17 × 10\n   `@type`     format accessURL resourcesAPI description title modified temporal\n   <chr>       <chr>  <chr>     <chr>        <chr>       <chr> <chr>    <chr>   \n 1 dcat:Distr… API    https://… https://dat… latest      Medi… 2025-01… 2024-10…\n 2 dcat:Distr… <NA>   <NA>      https://dat… <NA>        Medi… 2025-01… 2024-10…\n 3 dcat:Distr… API    https://… https://dat… <NA>        Medi… 2025-01… 2024-10…\n 4 dcat:Distr… <NA>   <NA>      https://dat… <NA>        Medi… 2024-10… 2024-07…\n 5 dcat:Distr… API    https://… https://dat… <NA>        Medi… 2024-10… 2024-07…\n 6 dcat:Distr… <NA>   <NA>      https://dat… <NA>        Medi… 2024-07… 2024-04…\n 7 dcat:Distr… API    https://… https://dat… <NA>        Medi… 2024-07… 2024-04…\n 8 dcat:Distr… <NA>   <NA>      https://dat… <NA>        Medi… 2024-04… 2024-01…\n 9 dcat:Distr… API    https://… https://dat… <NA>        Medi… 2024-04… 2024-01…\n10 dcat:Distr… <NA>   <NA>      https://dat… <NA>        Medi… 2024-01… 2023-10…\n11 dcat:Distr… API    https://… https://dat… <NA>        Medi… 2024-01… 2023-10…\n12 dcat:Distr… <NA>   <NA>      https://dat… <NA>        Medi… 2023-10… 2023-07…\n13 dcat:Distr… API    https://… https://dat… <NA>        Medi… 2023-10… 2023-07…\n14 dcat:Distr… <NA>   <NA>      https://dat… <NA>        Medi… 2023-09… 2023-04…\n15 dcat:Distr… API    https://… https://dat… <NA>        Medi… 2023-09… 2023-04…\n16 dcat:Distr… <NA>   <NA>      https://dat… <NA>        Medi… 2023-04… 2023-01…\n17 dcat:Distr… API    https://… https://dat… <NA>        Medi… 2023-04… 2023-01…\n# ℹ 2 more variables: downloadURL <chr>, mediaType <chr>\n```\n\n\n:::\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncollapse::fsubset(\n    distribution(ffs, \"Fee-For-Service\"), \n    description %==% \"latest\") |> \n  purse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- $@type        c1  dcat:Distribution                                       ...\n- $format       c1  API                                                     ...\n- $accessURL    c1  https://data.cms.gov/data-api/v1/dataset/2457ea29-fc82- ...\n- $resourcesAPI c1  https://data.cms.gov/data-api/v1/dataset-resources/2457 ...\n- $description  c1  latest                                                  ...\n- $title        c1  Medicare Fee-For-Service Public Provider Enrollment : 2 ...\n- $modified     c1  2025-01-15                                              ...\n- $temporal     c1  2024-10-01/2024-12-31                                   ...\n- $downloadURL  c1  NA                                                      ...\n- $mediaType    c1  NA                                                      ...\n```\n\n\n:::\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncollapse::fsubset(\n    distribution(ffs, \"Fee-For-Service\"), \n    format %==% \"API\") |> \n  purse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- $@type        c9  dcat:Distribution                                       ...\n- $format       c9  API                                                     ...\n- $accessURL    c9  https://data.cms.gov/data-api/v1/dataset/2457ea29-fc82- ...\n- $resourcesAPI c9  https://data.cms.gov/data-api/v1/dataset-resources/2457 ...\n- $description  c9  latest                                                  ...\n- $title        c9  Medicare Fee-For-Service Public Provider Enrollment : 2 ...\n- $modified     c9  2025-01-15                                              ...\n- $temporal     c9  2024-10-01/2024-12-31                                   ...\n- $downloadURL  c9  NA                                                      ...\n- $mediaType    c9  NA                                                      ...\n```\n\n\n:::\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncollapse::fsubset(\n    distribution(ffs, \"Fee-For-Service\"), \n    mediaType %==% \"text/csv\") |> \n  purse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- $@type        c8  dcat:Distribution                                       ...\n- $format       c8  NA                                                      ...\n- $accessURL    c8  NA                                                      ...\n- $resourcesAPI c8  https://data.cms.gov/data-api/v1/dataset-resources/7dcf ...\n- $description  c8  NA                                                      ...\n- $title        c8  Medicare Fee-For-Service Public Provider Enrollment : 2 ...\n- $modified     c8  2025-01-15                                              ...\n- $temporal     c8  2024-10-01/2024-12-31                                   ...\n- $downloadURL  c8  https://data.cms.gov/sites/default/files/2025-01/8ced28 ...\n- $mediaType    c8  text/csv                                                ...\n```\n\n\n:::\n:::\n\n## URLS\n\n::: {.cell}\n\n```{.r .cell-code}\nlist(\n  dataset = provider_dataset, \n  latest = provider_latest,\n  api = provider_api,\n  csv = provider_csv\n  )\n```\n:::\n\n\n## No. of Results\n\n::: {.cell}\n\n```{.r .cell-code}\nrequest(urls$base) |> \n  req_url_path_append(urls$identifier) |> \n  req_url_path_append(\"stats\") |> \n  req_perform() |> \n  resp_body_json(simplifyVector = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nquery <- glue::glue(\n  '\n  \"filter[fID{fID}][path]\" = \"{PATH}\",\n  \"filter[fID{fID}][operator]\" = \"{OPERATOR}\",\n  \"filter[fID{fID}][value]\" = \"{VALUE}\"\n  ', \n  fID = 1:2, \n  PATH = c(\"STATE_CD\", \"LAST_NAME\"), \n  OPERATOR = \"=\",\n  VALUE = c(\"GA\", \"SMITH\")\n  ) |> \n  glue::glue_collapse(sep = \",\\n\")\n\nquery <- glue::glue('c({query})') |> \n  rlang::parse_expr() |> \n  rlang::eval_bare()\n\nrequest(urls$base) |> \n  req_url_path_append(urls$identifier) |> \n  req_url_path_append(\"stats\") |> \n  req_url_query(!!!query) |> \n  req_perform() |> \n  resp_body_json(simplifyVector = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nresp <- request(urls$base) |> \n  req_url_path_append(urls$identifier) |> \n  req_url_query(!!!query, size = 5000) |> \n  req_perform()\n\nresp <- RcppSimdJson::fparse(httr2::resp_body_string(resp))\n\ncollapse::qTBL(resp[[\"data\"]]) |>\n  setNames(c(\"NPI\", \"PECOS_ASCT_CNTL_ID\", \"ENRLMT_ID\", \n             \"PROVIDER_TYPE_CD\", \"PROVIDER_TYPE_DESC\", \n             \"STATE_CD\", \"FIRST_NAME\", \"MDL_NAME\", \n             \"LAST_NAME\", \"ORG_NAME\", \"GNDR_SW\"))\n```\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nformat_syntax <- \\(name, value) {\n  setNames(\n    value, \n    paste0(\n      name, \n      \"[id-\", \n      seq_along(value), \n      \"][condition][value]\"))\n}\n\nformat_syntax(\"filter\", c(\"GA\", \"NY\"))\n\n\n# query_syntax <- c(\n#   \"filter[STATE_CD]\" = \"GA\",\n#   \"filter[LAST_NAME]\" = \"SMITH\"\n#   )\n```\n:::\n\n--------------------------------------------------------------------------------\n",
    "supporting": [
      "end_enrollees_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}