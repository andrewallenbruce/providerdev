{
  "hash": "ead0dcd1177086dfc202d9cb604aee27",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Providers\"\neditor_options: \n   chunk_output_type: console\n---\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<a href=\"https://andrewallenbruce.github.io/provider/reference/providers.html\" class=\"btn btn-outline-secondary\" role=\"button\" target=\"_blank\">\n<i class=\"bi bi-box-arrow-up-right\"></i>\nDocumentation\n</a>\n<a href=\"https://github.com/andrewallenbruce/provider/blob/main/R/providers.R\" class=\"btn btn-outline-secondary\" role=\"button\" target=\"_blank\">\n<i class=\"bi bi-box-arrow-up-right\"></i>\nSource\n</a>\n```\n\n:::\n:::\n\n   * Base URL: `https://data.cms.gov/data-api/v1/`\n   * Identifier: `2457ea29-fc82-48b0-86ec-3b0755de7515`\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# distro <- collapse::fselect(dataset, distribution) |>\n#     tidyr::unnest(distribution) |>\n#     collapse::frename(remove_at_symbol)\n```\n:::\n\n## Catalog\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmain_data_raw <- \\() {\n\n  x <- RcppSimdJson::fload(\"https://data.cms.gov/data.json\")\n\n  list(\n    context             = x[[\"@context\"]],\n    id                  = x[[\"@id\"]],\n    type                = x[[\"@type\"]],\n    conformsTo          = x[[\"conformsTo\"]],\n    describedBy         = x[[\"describedBy\"]],\n    dataset             = collapse::qTBL(x[[\"dataset\"]]) |>\n    collapse::fmutate(\n      bureauCode   = delist(bureauCode),\n      language     = delist(language),\n      programCode  = delist(programCode),\n      references   = delist(references),\n      theme        = flatten_column(theme),\n      keyword      = flatten_column(keyword)) |>\n    collapse::frename(remove_at_symbol)\n  )\n}\n\nmain <- main_data_raw()\n\nmain\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$context\n[1] \"https://project-open-data.cio.gov/v1.1/schema/catalog.jsonld\"\n\n$id\n[1] \"https://data.cms.gov/data.json\"\n\n$type\n[1] \"dcat:Catalog\"\n\n$conformsTo\n[1] \"https://project-open-data.cio.gov/v1.1/schema\"\n\n$describedBy\n[1] \"https://project-open-data.cio.gov/v1.1/schema/catalog.json\"\n\n$dataset\n# A tibble: 139 × 22\n   type       accessLevel accrualPeriodicity bureauCode contactPoint describedBy\n   <chr>      <chr>       <chr>              <chr>      <list>       <chr>      \n 1 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 2 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 3 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 4 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 5 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 6 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 7 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 8 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 9 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n10 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n# ℹ 129 more rows\n# ℹ 16 more variables: dataQuality <lgl>, description <chr>,\n#   distribution <list>, identifier <chr>, keyword <chr>, landingPage <chr>,\n#   language <chr>, license <chr>, modified <chr>, programCode <chr>,\n#   publisher <list>, references <chr>, temporal <chr>, theme <chr>,\n#   title <chr>, describedByType <chr>\n```\n\n\n:::\n:::\n\n## Dataset\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nselect_dataset <- \\(x, set) {\n  list(\n    context             = x[[\"context\"]],\n    id                  = x[[\"id\"]],\n    type                = x[[\"type\"]],\n    conformsTo          = x[[\"conformsTo\"]],\n    describedBy         = x[[\"describedBy\"]],\n    dataset             = collapse::fsubset(\n      x[[\"dataset\"]], \n      fuimus::sf_detect(title, set))\n  )\n}\n\nx <- select_dataset(main, \"Fee-For-Service\")\n\nx |> purse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- $context                        c1  https://project-open-data.cio.gov/v1. ...\n- $id                             c1  https://data.cms.gov/data.json\n- $type                           c1  dcat:Catalog\n- $conformsTo                     c1  https://project-open-data.cio.gov/v1. ...\n- $describedBy                    c1  https://project-open-data.cio.gov/v1. ...\n- $dataset    $type               c1  dcat:Dataset                          ...\n- $dataset    $accessLevel        c1  public                                ...\n- $dataset    $accrualPeriodicity c1  R/P3M                                 ...\n- $dataset    $bureauCode         c1  009:38                                ...\n- $dataset    $contactPoint       L1  list(list(\"@type\" = \"vcard:Contact\",  ...\n- $dataset    $describedBy        c1  https://data.cms.gov/resources/medica ...\n- $dataset    $dataQuality        l1  T                                     ...\n- $dataset    $description        c1  The Medicare Fee-For-Service Public P ...\n- $dataset    $distribution       L1  list(structure(list(\"@type\" = c(\"dcat ...\n- $dataset    $identifier         c1  https://data.cms.gov/data-api/v1/data ...\n- $dataset    $keyword            c1  Medicare, Original Medicare, Provider ...\n- $dataset    $landingPage        c1  https://data.cms.gov/provider-charact ...\n- $dataset    $language           c1  en-US                                 ...\n- $dataset    $license            c1  https://www.usa.gov/government-works  ...\n- $dataset    $modified           c1  2024-10-16                            ...\n- $dataset    $programCode        c1  009:000                               ...\n- $dataset    $publisher          L1  list(list(\"@type\" = \"org:Organization ...\n- $dataset    $references         c1  https://data.cms.gov/resources/fee-fo ...\n- $dataset    $temporal           c1  2023-01-01/2024-09-30                 ...\n- $dataset    $theme              c1  Medicare                              ...\n- $dataset    $title              c1  Medicare Fee-For-Service  Public Prov ...\n- $dataset    $describedByType    c1  NA                                    ...\n```\n\n\n:::\n:::\n\n\n## Distribution\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncollapse::qTBL(x$dataset$distribution[[1]]) |> \n  collapse::frename(remove_at_symbol) |> \n  purse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- $type         c15 dcat:Distribution                                       ...\n- $format       c15 API                                                     ...\n- $accessURL    c15 https://data.cms.gov/data-api/v1/dataset/2457ea29-fc82- ...\n- $resourcesAPI c15 https://data.cms.gov/data-api/v1/dataset-resources/2457 ...\n- $description  c15 latest                                                  ...\n- $title        c15 Medicare Fee-For-Service Public Provider Enrollment : 2 ...\n- $modified     c15 2024-10-16                                              ...\n- $temporal     c15 2024-07-01/2024-09-30                                   ...\n- $downloadURL  c15 NA                                                      ...\n- $mediaType    c15 NA                                                      ...\n```\n\n\n:::\n:::\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nprovider_latest <- collapse::fsubset(\n    main[[\"distribution_latest\"]],\n    fuimus::sf_detect(\n      title, \n      \"Fee-For-Service\"\n      ))\n\nprovider_latest |> purse()\n```\n:::\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nprovider_api <- collapse::fsubset(\n    main[[\"distribution_api\"]],\n    fuimus::sf_detect(\n      title, \n      \"Fee-For-Service\"\n      ))\n\nprovider_api |> purse()\n```\n:::\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nprovider_csv <- collapse::fsubset(\n    main[[\"distribution_csv\"]],\n    fuimus::sf_detect(\n      title, \n      \"Fee-For-Service\"\n      ))\n\nprovider_csv |> purse()\n```\n:::\n\n## URLS\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlist(\n  dataset = provider_dataset, \n  latest = provider_latest,\n  api = provider_api,\n  csv = provider_csv\n  )\n```\n:::\n\n\n## No. of Results\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nrequest(urls$base) |> \n  req_url_path_append(urls$identifier) |> \n  req_url_path_append(\"stats\") |> \n  req_perform() |> \n  resp_body_json(simplifyVector = TRUE)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nquery <- glue::glue(\n  '\n  \"filter[fID{fID}][path]\" = \"{PATH}\",\n  \"filter[fID{fID}][operator]\" = \"{OPERATOR}\",\n  \"filter[fID{fID}][value]\" = \"{VALUE}\"\n  ', \n  fID = 1:2, \n  PATH = c(\"STATE_CD\", \"LAST_NAME\"), \n  OPERATOR = \"=\",\n  VALUE = c(\"GA\", \"SMITH\")\n  ) |> \n  glue::glue_collapse(sep = \",\\n\")\n\nquery <- glue::glue('c({query})') |> \n  rlang::parse_expr() |> \n  rlang::eval_bare()\n\nrequest(urls$base) |> \n  req_url_path_append(urls$identifier) |> \n  req_url_path_append(\"stats\") |> \n  req_url_query(!!!query) |> \n  req_perform() |> \n  resp_body_json(simplifyVector = TRUE)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nresp <- request(urls$base) |> \n  req_url_path_append(urls$identifier) |> \n  req_url_query(!!!query, size = 5000) |> \n  req_perform()\n\nresp <- RcppSimdJson::fparse(httr2::resp_body_string(resp))\n\ncollapse::qTBL(resp[[\"data\"]]) |>\n  setNames(c(\"NPI\", \"PECOS_ASCT_CNTL_ID\", \"ENRLMT_ID\", \n             \"PROVIDER_TYPE_CD\", \"PROVIDER_TYPE_DESC\", \n             \"STATE_CD\", \"FIRST_NAME\", \"MDL_NAME\", \n             \"LAST_NAME\", \"ORG_NAME\", \"GNDR_SW\"))\n```\n:::\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nformat_syntax <- \\(name, value) {\n  setNames(\n    value, \n    paste0(\n      name, \n      \"[id-\", \n      seq_along(value), \n      \"][condition][value]\"))\n}\n\nformat_syntax(\"filter\", c(\"GA\", \"NY\"))\n\n\n# query_syntax <- c(\n#   \"filter[STATE_CD]\" = \"GA\",\n#   \"filter[LAST_NAME]\" = \"SMITH\"\n#   )\n```\n:::\n\n--------------------------------------------------------------------------------\n",
    "supporting": [
      "fn_providers_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}