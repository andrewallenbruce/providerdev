{
  "hash": "c8f43dbfc45c82bf1e9f742ddeb2a7af",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Providers\"\neditor_options: \n   chunk_output_type: console\n---\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<a href=\"https://andrewallenbruce.github.io/provider/reference/providers.html\" class=\"btn btn-outline-secondary\" role=\"button\" target=\"_blank\">\n<i class=\"bi bi-box-arrow-up-right\"></i>\nDocumentation\n</a>\n<a href=\"https://github.com/andrewallenbruce/provider/blob/main/R/providers.R\" class=\"btn btn-outline-secondary\" role=\"button\" target=\"_blank\">\n<i class=\"bi bi-box-arrow-up-right\"></i>\nSource\n</a>\n```\n\n:::\n:::\n\n   * Base URL: `https://data.cms.gov/data-api/v1/`\n   * Identifier: `2457ea29-fc82-48b0-86ec-3b0755de7515`\n\n## Objects\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmain <- main_data_rcpp()\n\nmain\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$context\n[1] \"https://project-open-data.cio.gov/v1.1/schema/catalog.jsonld\"\n\n$id\n[1] \"https://data.cms.gov/data.json\"\n\n$type\n[1] \"dcat:Catalog\"\n\n$conformsTo\n[1] \"https://project-open-data.cio.gov/v1.1/schema\"\n\n$describedBy\n[1] \"https://project-open-data.cio.gov/v1.1/schema/catalog.json\"\n\n$dataset\n# A tibble: 139 × 21\n   type       accessLevel accrualPeriodicity bureauCode contactPoint describedBy\n   <chr>      <chr>       <chr>              <chr>      <list>       <chr>      \n 1 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 2 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 3 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 4 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 5 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 6 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 7 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 8 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 9 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n10 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n# ℹ 129 more rows\n# ℹ 15 more variables: dataQuality <lgl>, description <chr>, identifier <chr>,\n#   keyword <chr>, landingPage <chr>, language <chr>, license <chr>,\n#   modified <chr>, programCode <chr>, publisher <list>, references <chr>,\n#   temporal <chr>, theme <chr>, title <chr>, describedByType <chr>\n\n$distribution_latest\n# A tibble: 112 × 8\n   type        format accessURL resourcesAPI description title modified temporal\n   <chr>       <chr>  <chr>     <chr>        <chr>       <chr> <chr>    <chr>   \n 1 dcat:Distr… API    https://… https://dat… latest      Acco… 2024-01… 2024-01…\n 2 dcat:Distr… API    https://… https://dat… latest      Acco… 2024-04… 2024-01…\n 3 dcat:Distr… API    https://… https://dat… latest      ACO … 2024-01… 2021-01…\n 4 dcat:Distr… API    https://… https://dat… latest      ACO … 2024-01… 2021-01…\n 5 dcat:Distr… API    https://… https://dat… latest      ACO … 2024-01… 2021-01…\n 6 dcat:Distr… API    https://… https://dat… latest      ACO … 2024-01… 2021-01…\n 7 dcat:Distr… API    https://… https://dat… latest      Adva… 2024-01… 2024-01…\n 8 dcat:Distr… API    https://… https://dat… latest      Agen… 2020-12… 2016-01…\n 9 dcat:Distr… API    https://… https://dat… latest      Comp… 2021-01… 2020-01…\n10 dcat:Distr… API    https://… https://dat… latest      Coun… 2024-12… 2023-01…\n# ℹ 102 more rows\n\n$distribution_api\n# A tibble: 1,632 × 7\n   type              format accessURL       resourcesAPI title modified temporal\n   <chr>             <chr>  <chr>           <chr>        <chr> <chr>    <chr>   \n 1 dcat:Distribution API    https://data.c… https://dat… Acco… 2024-01… 2024-01…\n 2 dcat:Distribution API    https://data.c… https://dat… Acco… 2023-03… 2023-01…\n 3 dcat:Distribution API    https://data.c… https://dat… Acco… 2022-01… 2022-01…\n 4 dcat:Distribution API    https://data.c… https://dat… Acco… 2022-01… 2021-01…\n 5 dcat:Distribution API    https://data.c… https://dat… Acco… 2022-01… 2020-01…\n 6 dcat:Distribution API    https://data.c… https://dat… Acco… 2024-01… 2019-01…\n 7 dcat:Distribution API    https://data.c… https://dat… Acco… 2022-01… 2019-01…\n 8 dcat:Distribution API    https://data.c… https://dat… Acco… 2022-01… 2018-01…\n 9 dcat:Distribution API    https://data.c… https://dat… Acco… 2022-01… 2017-01…\n10 dcat:Distribution API    https://data.c… https://dat… Acco… 2022-01… 2016-01…\n# ℹ 1,622 more rows\n\n$distribution_csv\n# A tibble: 1,610 × 7\n   type              resourcesAPI  title modified temporal downloadURL mediaType\n   <chr>             <chr>         <chr> <chr>    <chr>    <chr>       <chr>    \n 1 dcat:Distribution https://data… Acco… 2024-01… 2024-01… https://da… text/csv \n 2 dcat:Distribution https://data… Acco… 2023-03… 2023-01… https://da… text/csv \n 3 dcat:Distribution https://data… Acco… 2022-01… 2022-01… https://da… text/csv \n 4 dcat:Distribution https://data… Acco… 2024-04… 2024-01… https://da… text/csv \n 5 dcat:Distribution https://data… Acco… 2023-03… 2023-01… https://da… text/csv \n 6 dcat:Distribution https://data… Acco… 2022-01… 2022-01… https://da… text/csv \n 7 dcat:Distribution https://data… ACO … 2024-01… 2021-01… https://da… text/csv \n 8 dcat:Distribution https://data… ACO … 2024-01… 2021-01… https://da… text/csv \n 9 dcat:Distribution https://data… ACO … 2024-01… 2021-01… https://da… text/csv \n10 dcat:Distribution https://data… ACO … 2024-01… 2021-01… https://da… text/csv \n# ℹ 1,600 more rows\n```\n\n\n:::\n:::\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmain$dataset |> \n  collapse::fsubset(\n    fuimus::sf_detect(title, \"Fee-For-Service\")\n    ) |> \n  purse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- $type               c1 dcat:Dataset                                       ...\n- $accessLevel        c1 public                                             ...\n- $accrualPeriodicity c1 R/P3M                                              ...\n- $bureauCode         c1 009:38                                             ...\n- $contactPoint       L1 list(list(\"@type\" = \"vcard:Contact\", fn = \"Provide ...\n- $describedBy        c1 https://data.cms.gov/resources/medicare-fee-for-se ...\n- $dataQuality        l1 T                                                  ...\n- $description        c1 The Medicare Fee-For-Service Public Provider Enrol ...\n- $identifier         c1 https://data.cms.gov/data-api/v1/dataset/2457ea29- ...\n- $keyword            c1 Medicare, Original Medicare, Provider Enrollment   ...\n- $landingPage        c1 https://data.cms.gov/provider-characteristics/medi ...\n- $language           c1 en-US                                              ...\n- $license            c1 https://www.usa.gov/government-works               ...\n- $modified           c1 2024-10-16                                         ...\n- $programCode        c1 009:000                                            ...\n- $publisher          L1 list(list(\"@type\" = \"org:Organization\", name = \"Ce ...\n- $references         c1 https://data.cms.gov/resources/fee-for-service-pub ...\n- $temporal           c1 2023-01-01/2024-09-30                              ...\n- $theme              c1 Medicare                                           ...\n- $title              c1 Medicare Fee-For-Service  Public Provider Enrollme ...\n- $describedByType    c1 NA                                                 ...\n```\n\n\n:::\n:::\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmain$distribution_latest |> \n  collapse::fsubset(\n    fuimus::sf_detect(title, \"Fee-For-Service\")\n    ) |> \n  purse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- $type         c1 dcat:Distribution                                        ...\n- $format       c1 API                                                      ...\n- $accessURL    c1 https://data.cms.gov/data-api/v1/dataset/2457ea29-fc82-4 ...\n- $resourcesAPI c1 https://data.cms.gov/data-api/v1/dataset-resources/2457e ...\n- $description  c1 latest                                                   ...\n- $title        c1 Medicare Fee-For-Service Public Provider Enrollment : 20 ...\n- $modified     c1 2024-10-16                                               ...\n- $temporal     c1 2024-07-01/2024-09-30                                    ...\n```\n\n\n:::\n:::\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmain$distribution_api |> \n  collapse::fsubset(\n    fuimus::sf_detect(title, \"Fee-For-Service\"),\n    title, accessURL, resourcesAPI, modified, temporal\n    ) |> \n  purse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- $title        c7 Medicare Fee-For-Service Public Provider Enrollment : 20 ...\n- $accessURL    c7 https://data.cms.gov/data-api/v1/dataset/57312fe7-f2cc-4 ...\n- $resourcesAPI c7 https://data.cms.gov/data-api/v1/dataset-resources/57312 ...\n- $modified     c7 2024-10-16                                               ...\n- $temporal     c7 2024-07-01/2024-09-30                                    ...\n```\n\n\n:::\n:::\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmain$distribution_csv |> \n  collapse::fsubset(fuimus::sf_detect(title, \"Fee-For-Service\")) |> \n  purse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- $type         c7 dcat:Distribution                                        ...\n- $resourcesAPI c7 https://data.cms.gov/data-api/v1/dataset-resources/57312 ...\n- $title        c7 Medicare Fee-For-Service Public Provider Enrollment : 20 ...\n- $modified     c7 2024-10-16                                               ...\n- $temporal     c7 2024-07-01/2024-09-30                                    ...\n- $downloadURL  c7 https://data.cms.gov/sites/default/files/2024-10/8e1bbad ...\n- $mediaType    c7 text/csv                                                 ...\n```\n\n\n:::\n:::\n\n## URLS\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nurls <- list(\n  base = \"https://data.cms.gov/data-api/v1/dataset\",\n  identifier = filter(\n    main_dataset, \n    fuimus::sf_detect(title, \"Fee-For-Service\")) |> \n    pull(identifier) |> \n    fuimus::sf_remove(\"https://data.cms.gov/data-api/v1/dataset/\"),\n  accessURL = filter(\n    main_distribution, \n    fuimus::sf_detect(title, \"Fee-For-Service\"), \n    description == \"latest\") |> \n    pull(accessURL) |> \n    fuimus::sf_remove(\"https://data.cms.gov/data-api/v1/dataset/\"),\n  resourcesAPI = filter(\n    main_distribution, \n    fuimus::sf_detect(title, \"Fee-For-Service\"), \n    description == \"latest\") |> \n    pull(resourcesAPI) |> \n    fuimus::sf_remove(\"https://data.cms.gov/data-api/v1/dataset\")\n  )\n\nurls |> purse()\n```\n:::\n\n\n## No. of Results\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nrequest(urls$base) |> \n  req_url_path_append(urls$identifier) |> \n  req_url_path_append(\"stats\") |> \n  req_perform() |> \n  resp_body_json(simplifyVector = TRUE)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nquery <- glue::glue(\n  '\n  \"filter[fID{fID}][path]\" = \"{PATH}\",\n  \"filter[fID{fID}][operator]\" = \"{OPERATOR}\",\n  \"filter[fID{fID}][value]\" = \"{VALUE}\"\n  ', \n  fID = 1:2, \n  PATH = c(\"STATE_CD\", \"LAST_NAME\"), \n  OPERATOR = \"=\",\n  VALUE = c(\"GA\", \"SMITH\")\n  ) |> \n  glue::glue_collapse(sep = \",\\n\")\n\nquery <- glue::glue('c({query})') |> \n  rlang::parse_expr() |> \n  rlang::eval_bare()\n\nrequest(urls$base) |> \n  req_url_path_append(urls$identifier) |> \n  req_url_path_append(\"stats\") |> \n  req_url_query(!!!query) |> \n  req_perform() |> \n  resp_body_json(simplifyVector = TRUE)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nresp <- request(urls$base) |> \n  req_url_path_append(urls$identifier) |> \n  req_url_query(!!!query, size = 5000) |> \n  req_perform()\n\nresp <- RcppSimdJson::fparse(httr2::resp_body_string(resp))\n\ncollapse::qTBL(resp[[\"data\"]]) |>\n  setNames(c(\"NPI\", \"PECOS_ASCT_CNTL_ID\", \"ENRLMT_ID\", \n             \"PROVIDER_TYPE_CD\", \"PROVIDER_TYPE_DESC\", \n             \"STATE_CD\", \"FIRST_NAME\", \"MDL_NAME\", \n             \"LAST_NAME\", \"ORG_NAME\", \"GNDR_SW\"))\n```\n:::\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nformat_syntax <- \\(name, value) {\n  setNames(\n    value, \n    paste0(\n      name, \n      \"[id-\", \n      seq_along(value), \n      \"][condition][value]\"))\n}\n\nformat_syntax(\"filter\", c(\"GA\", \"NY\"))\n\n\n# query_syntax <- c(\n#   \"filter[STATE_CD]\" = \"GA\",\n#   \"filter[LAST_NAME]\" = \"SMITH\"\n#   )\n```\n:::\n\n\n\n\n\n",
    "supporting": [
      "fn_providers_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}