{
  "hash": "4d0d742dfe2b31eb77174eccd9fe9800",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"URL Object\"\neditor_options: \n   chunk_output_type: console\n---\n\n::: {.cell}\n\n:::\n\n## `class_path`\n\n::: {.cell}\n\n```{.r .cell-code}\nclass_path <- new_class(\n  name = \"class_path\",\n  properties = list(\n    head = new_property(\n      class_character,\n      default = \"\",\n      setter = function(self, value) {\n        self@head <- value\n        self\n      }),\n    guid = new_property(\n      class_character,\n      default = \"\",\n      setter = function(self, value) {\n        self@guid <- value\n        self\n      }),\n    tail = new_property(\n      class_character,\n      default = \"\",\n      setter = function(self, value) {\n        self@tail <- value\n        self\n      })\n  ),\n  validator = function(self) { \n    if (length(self@head) != 1L) \"@head must be length 1\" \n    if (length(self@guid) != 1L) \"@guid must be length 1\" \n    if (nchar(self@guid) == 36 & \n        !grepl(\n          \"(?:\\\\{{0,1}(?:[0-9a-fA-F]){8}-(?:[0-9a-fA-F]){4}-(?:[0-9a-fA-F]){4}-(?:[0-9a-fA-F]){4}-(?:[0-9a-fA-F]){12}\\\\}{0,1})\", \n          self@guid)) \n      \"@guid invalid\"\n    if (length(self@tail) != 1L) \"@tail must be length 1\"\n  }\n)\n\nclass_path()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n<class_path>\n @ head: chr \"\"\n @ guid: chr \"\"\n @ tail: chr \"\"\n```\n\n\n:::\n:::\n\n## `class_url`\n\n::: {.cell}\n\n```{.r .cell-code}\nclass_url <- new_class(\n  name = \"class_url\",\n  properties = list(\n    scheme = new_property(class_character, default = \"https\"),\n    hostname = new_property(class_character, default = \"data.cms.gov\"),\n    path = new_property(class_path),\n    query = new_property(class_list, default = list())\n  )\n)\n\nclass_url()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n<class_url>\n @ scheme  : chr \"https\"\n @ hostname: chr \"data.cms.gov\"\n @ path    : <class_path>\n .. @ head: chr \"\"\n .. @ guid: chr \"\"\n .. @ tail: chr \"\"\n @ query   : list()\n```\n\n\n:::\n:::\n\n## GUID\n\n__GUID__ is an acronym for [Globally Unique Identifier](https://uibakery.io/regex-library/guid-regex-python) and used for resource identification. The term is generally used instead of UUID when working with Microsoft technologies.\n\n::: {.cell}\n\n```{.r .cell-code}\n# regex to validate\n\"^(?:\\\\{{0,1}(?:[0-9a-fA-F]){8}-(?:[0-9a-fA-F]){4}-(?:[0-9a-fA-F]){4}-(?:[0-9a-fA-F]){4}-(?:[0-9a-fA-F]){12}\\\\}{0,1})$\"\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"^(?:\\\\{{0,1}(?:[0-9a-fA-F]){8}-(?:[0-9a-fA-F]){4}-(?:[0-9a-fA-F]){4}-(?:[0-9a-fA-F]){4}-(?:[0-9a-fA-F]){12}\\\\}{0,1})$\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# regex to extract\n\"(?:\\\\{{0,1}(?:[0-9a-fA-F]){8}-(?:[0-9a-fA-F]){4}-(?:[0-9a-fA-F]){4}-(?:[0-9a-fA-F]){4}-(?:[0-9a-fA-F]){12}\\\\}{0,1})\"\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"(?:\\\\{{0,1}(?:[0-9a-fA-F]){8}-(?:[0-9a-fA-F]){4}-(?:[0-9a-fA-F]){4}-(?:[0-9a-fA-F]){4}-(?:[0-9a-fA-F]){12}\\\\}{0,1})\"\n```\n\n\n:::\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncurl::curl_parse_url(\n  \"https://data.cms.gov/data-api/v1/dataset/9887a515-7552-4693-bf58-735c77af46d7/data-viewer?size=5000&offset=10000\"\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$url\n[1] \"https://data.cms.gov/data-api/v1/dataset/9887a515-7552-4693-bf58-735c77af46d7/data-viewer?size=5000&offset=10000\"\n\n$scheme\n[1] \"https\"\n\n$host\n[1] \"data.cms.gov\"\n\n$port\nNULL\n\n$path\n[1] \"/data-api/v1/dataset/9887a515-7552-4693-bf58-735c77af46d7/data-viewer\"\n\n$query\n[1] \"size=5000&offset=10000\"\n\n$fragment\nNULL\n\n$user\nNULL\n\n$password\nNULL\n\n$params\n   size  offset \n \"5000\" \"10000\" \n```\n\n\n:::\n\n```{.r .cell-code}\nnew_path <- \\(url) {\n  class_path(\n    head = stringi::stri_extract(url, regex = \"[0-9a-z]{8}-[0-9]{4}-[0-9]{4}-[0-9a-z]{4}-[0-9a-z]{8}\"),\n    guid = stringi::stri_extract(url, regex = \"[0-9a-z]{8}-[0-9]{4}-[0-9]{4}-[0-9a-z]{4}-[0-9a-z]{8}\")\n    )\n}\n\nnew_path(\"https://data.cms.gov/data-api/v1/dataset/9887a515-7552-4693-bf58-735c77af46d7/data-viewer?size=5000&offset=10000\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n<class_path>\n @ head: chr \"9887a515-7552-4693-bf58-735c77af\"\n @ guid: chr \"9887a515-7552-4693-bf58-735c77af\"\n @ tail: chr \"\"\n```\n\n\n:::\n:::\n\n## Examples\n\n::: {.cell}\n\n```{.r .cell-code}\nurls <- c(\n  \"https://data.cms.gov/data-api/v1/dataset/9887a515-7552-4693-bf58-735c77af46d7/data/stats\",\n  \"https://data.cms.gov/data-api/v1/dataset/9887a515-7552-4693-bf58-735c77af46d7/data-viewer?size=5000&offset=10000\"\n  )\n\nurlparse::url_parse_v2(urls) |> \n  handle_na() |> \n  select(path, raw_query)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                                                                   path\n1  /data-api/v1/dataset/9887a515-7552-4693-bf58-735c77af46d7/data/stats\n2 /data-api/v1/dataset/9887a515-7552-4693-bf58-735c77af46d7/data-viewer\n               raw_query\n1                   <NA>\n2 size=5000&offset=10000\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhttr2::url_parse(\n  base_url = \"https://data.cms.gov/data-api/v1/dataset\", \n  url      = \"9887a515-7552-4693-bf58-735c77af46d7/data-viewer\") |> \n  httr2::url_modify_query(\n    offset = 0, \n    limit  = 2000) |> \n  httr2::url_modify(path = \"data-api/v1/9887a515-7552-4693-bf58-735c77af46d7/data/stats\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n<httr2_url>\nhttps://data.cms.gov/data-api/v1/9887a515-7552-4693-bf58-735c77af46d7/data/stats?offset=0&limit=2000\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n• scheme: https\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n• hostname: data.cms.gov\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n• path: data-api/v1/9887a515-7552-4693-bf58-735c77af46d7/data/stats\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n• query:\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n  • offset: 0\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n  • limit: 2000\n```\n\n\n:::\n:::\n\nRe-setting part of the path:\n\n::: {.cell}\n\n```{.r .cell-code}\nex <- class_url(\n  path = class_path(\n    head = \"data-api/v1/dataset\",\n    guid = \"9887a515-7552-4693-bf58-735c77af46d7\",\n    tail = \"data-viewer\"))\n\nex\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n<class_url>\n @ scheme  : chr \"https\"\n @ hostname: chr \"data.cms.gov\"\n @ path    : <class_path>\n .. @ head: chr \"data-api/v1/dataset\"\n .. @ guid: chr \"9887a515-7552-4693-bf58-735c77af46d7\"\n .. @ tail: chr \"data-viewer\"\n @ query   : list()\n```\n\n\n:::\n\n```{.r .cell-code}\nex@path@tail <- \"data/stats\"\n\nex\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n<class_url>\n @ scheme  : chr \"https\"\n @ hostname: chr \"data.cms.gov\"\n @ path    : <class_path>\n .. @ head: chr \"data-api/v1/dataset\"\n .. @ guid: chr \"9887a515-7552-4693-bf58-735c77af46d7\"\n .. @ tail: chr \"data/stats\"\n @ query   : list()\n```\n\n\n:::\n:::\n\nWith httr2:\n\n::: {.cell}\n\n```{.r .cell-code}\nhttr2::url_parse(\n  base_url = \"https://data.cms.gov/provider-data/\", \n  url      = \"api/1/datastore/query/mj5m-pzi6/0\") |> \n  httr2::url_modify_query(\n    offset = 0, \n    limit  = 2000)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n<httr2_url>\nhttps://data.cms.gov/provider-data/api/1/datastore/query/mj5m-pzi6/0?offset=0&limit=2000\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n• scheme: https\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n• hostname: data.cms.gov\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n• path: /provider-data/api/1/datastore/query/mj5m-pzi6/0\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n• query:\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n  • offset: 0\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n  • limit: 2000\n```\n\n\n:::\n:::\n\nWith S7:\n\n::: {.cell}\n\n```{.r .cell-code}\nex2 <- class_url(\n  path = class_path(\n    head = \"/provider-data/api/1/datastore/query/\",\n    guid = \"mj5m-pzi6\",\n    tail = \"0\"))\n\nex2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n<class_url>\n @ scheme  : chr \"https\"\n @ hostname: chr \"data.cms.gov\"\n @ path    : <class_path>\n .. @ head: chr \"/provider-data/api/1/datastore/query/\"\n .. @ guid: chr \"mj5m-pzi6\"\n .. @ tail: chr \"0\"\n @ query   : list()\n```\n\n\n:::\n:::\n\n",
    "supporting": [
      "wk_url_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}