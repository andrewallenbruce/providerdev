{
  "hash": "13799f62561f52c32b5d985c73c2b4ec",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Open Payments API\"\neditor_options: \n   chunk_output_type: console\n---\n\n\n## Dataset\n\n   * `publisher`: `\"openpaymentsdata.cms.gov\"`\n   * `bureauCode`: `\"009:38\"`\n   * `programCode`: `\"009:000\"`\n   * `accessLevel`: `\"public\"`\n   * limit = `500`\n\n## Load Catalog\n\n::: {.cell}\n\n```{.r .cell-code}\nopen_describedby <- function(x) {\n  \n  x <- map(\n    get_elem(\n      get_elem(x$distribution, \n               \"data\", \n               DF.as.list = TRUE),\n      \"title|describedBy\",\n      regex = TRUE), \n    function(x) x[not_null(names(x))]\n    )\n  \n  new_df(\n    title       = delist(get_elem(x, \"title\")),\n    describedBy = delist(get_elem(x, \"describedBy\"))) |>\n    mtt(\n      year = as_int(stri_extract_all_regex(title, \"[0-9]{4}\")),\n      name = cheapr_if_else(na(year), title,\n                            stri_extract_all_regex(\n                              title, \n                              \"^.*(?=\\\\s.\\\\sDetailed Dataset [0-9]{4} Reporting Year)\")),\n      year = cheapr_if_else(na(year), fmax(year), year)) |>\n    sbt(year == fmax(year), \n        -year, \n        -title)\n}\n```\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nopen_downloadurl <- function(x) {\n  \n  add_vars(x, downloadURL = delist(get_elem(\n    get_elem(x$distribution, \"data\", DF.as.list = TRUE),\n    \"downloadURL\"\n  )))\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nopen_identifier_url <- function(x) {\n  \n  paste0(\n    \"https://openpaymentsdata.cms.gov/\",\n    \"api/1/datastore/query/\", \n    x, \n    \"/0\")\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncatalog_open_payments <- \\() {\n  \n  dataset <- as_tbl(\n  mtt(\n    fload(\"https://openpaymentsdata.cms.gov/api/1/metastore/schemas/dataset/items?show-reference-ids\"), \n    modified    = as_date(modified), \n    description = replace_fixed(description, c(\"\\n\", \"\\r. \\r.\", '\"'), c(\". \", \"\", \"\")),\n    theme       = delist(map(theme, function(x) get_elem(as.list(x), \"data\"))), \n    year        = delist(map(keyword, function(x) get_elem(as.list(x), \"data\"))), \n    year        = replace_fixed(year, c(\"all years\"), c(\"All\")),\n    year        = cheapr_if_else(title == \"Provider profile ID mapping table\", \"All\", year)))\n  \n  x <- slt(\n    open_downloadurl(dataset),\n    year,\n    theme,\n    title,\n    description,\n    modified,\n    temporal,\n    identifier,\n    downloadURL\n  ) |>\n    rsplit( ~ theme)\n  \n  list(\n    summary_all  = sbt(x$Summary, year == \"All\", -year) |>\n      mtt(title = tools::toTitleCase(title)) |>\n      roworder(title),\n    summary_year = sbt(x$Summary, year != \"All\") |>\n      mtt(\n        year = as_int(year),\n        title = stri_replace_all_regex(title, \"^[0-9]{4} \", \"\"),\n        title = tools::toTitleCase(title)\n      ) |>\n      roworder(title, -year),\n    general = mtt(\n      x$`General Payments`, \n      year = as_int(year), \n      title = \"General Payment Data\",\n      description = \"All general (non-research, non-ownership related) payments from the program year\"),\n    research = mtt(\n      x$`Research Payments`,\n      year = as_int(year),\n      title = \"Research Payment Data\",\n      description = \"All research-related payments from the program year\"\n    ),\n    ownership = mtt(\n      x$`Ownership Payments`,\n      year = as_int(year),\n      title = \"Ownership Payment Data\",\n      description = \"All ownership and investment payments from the program year\"\n    ),\n    dictionary = open_describedby(dataset)\n  )\n  \n}\n\nopenpay <- catalog_open_payments()\n\nopenpay\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$summary_all\n# A tibble: 18 × 6\n   title                  description modified   temporal identifier downloadURL\n   <chr>                  <chr>       <date>     <chr>    <chr>      <chr>      \n 1 Covered Recipient Pro… The Covere… 2025-01-30 2017-01… 23160558-… https://do…\n 2 National Level Paymen… This datas… 2025-01-30 2017-01… 04c3355f-… https://do…\n 3 National Level Paymen… This datas… 2025-01-30 2017-01… aaaddc12-… https://do…\n 4 Payments Grouped by C… This datas… 2025-01-30 2017-01… 8d4d1fa0-… https://do…\n 5 Payments Grouped by C… This datas… 2025-01-30 2017-01… e49defac-… https://do…\n 6 Payments Grouped by P… This datas… 2025-01-30 2017-01… 895260f5-… https://do…\n 7 Payments Grouped by R… This datas… 2025-01-30 2017-01… d5762bed-… https://do…\n 8 Payments Grouped by R… This datas… 2025-01-30 2017-01… 61efcbef-… https://do…\n 9 Payments Grouped by R… This datas… 2025-01-30 2017-01… ea5eea39-… https://do…\n10 Payments Grouped by T… This datas… 2025-01-30 2017-01… 217ad1a7-… https://do…\n11 Physician (Distinct) … This datas… 2025-01-30 <NA>     6ed6ae76-… https://do…\n12 Profile Information    This datas… 2025-01-30 <NA>     f2ed17cc-… https://do…\n13 Provider Profile ID M… Maps secon… 2025-01-30 2017-01… d19e5be2-… https://do…\n14 Reporting Entity Prof… This datas… 2025-01-30 <NA>     1cf0c6c0-… https://do…\n15 State Level Payment T… This datas… 2025-01-30 2017-01… 02157882-… https://do…\n16 State Payment Totals … Groups pay… 2025-01-30 2022-01… 7c5144d9-… https://do…\n17 Summary Dashboard - a… Summary da… 2025-01-30 2017-01… e0d225fc-… https://do…\n18 Teaching Hospital Pro… This datas… 2025-01-30 <NA>     8219fcb3-… https://do…\n\n$summary_year\n# A tibble: 35 × 7\n    year title            description modified   temporal identifier downloadURL\n   <int> <chr>            <chr>       <date>     <chr>    <chr>      <chr>      \n 1  2023 Payments Groupe… This datas… 2025-01-30 2023-01… 4017acfa-… https://do…\n 2  2022 Payments Groupe… This datas… 2025-01-30 2022-01… 686b765e-… https://do…\n 3  2021 Payments Groupe… This datas… 2025-01-30 2021-01… d35243be-… https://do…\n 4  2020 Payments Groupe… This datas… 2025-01-30 2020-01… 1fd2be47-… https://do…\n 5  2019 Payments Groupe… This datas… 2025-01-30 2019-01… 0ff0961f-… https://do…\n 6  2018 Payments Groupe… This datas… 2025-01-30 2018-01… 07c1e377-… https://do…\n 7  2017 Payments Groupe… This datas… 2025-01-30 2017-01… 5aad28fa-… https://do…\n 8  2023 Payments Groupe… This datas… 2025-01-30 2023-01… 4fbf0094-… https://do…\n 9  2022 Payments Groupe… This datas… 2025-01-30 2022-01… d2d87f39-… https://do…\n10  2021 Payments Groupe… This datas… 2025-01-30 2021-01… 7c9ebb83-… https://do…\n# ℹ 25 more rows\n\n$general\n# A tibble: 7 × 7\n   year title             description modified   temporal identifier downloadURL\n  <int> <chr>             <chr>       <date>     <chr>    <chr>      <chr>      \n1  2017 General Payment … All genera… 2025-01-30 2017-01… 74e3a32c-… https://do…\n2  2018 General Payment … All genera… 2025-01-30 2018-01… f003634c-… https://do…\n3  2019 General Payment … All genera… 2025-01-30 2019-01… 4e54dd6c-… https://do…\n4  2020 General Payment … All genera… 2025-01-30 2020-01… a08c4b30-… https://do…\n5  2021 General Payment … All genera… 2025-01-30 2021-01… 0380bbeb-… https://do…\n6  2022 General Payment … All genera… 2025-01-30 2022-01… df01c2f8-… https://do…\n7  2023 General Payment … All genera… 2025-01-30 2023-01… fb3a65aa-… https://do…\n\n$research\n# A tibble: 7 × 7\n   year title             description modified   temporal identifier downloadURL\n  <int> <chr>             <chr>       <date>     <chr>    <chr>      <chr>      \n1  2017 Research Payment… All resear… 2025-01-30 2017-01… 0e3977b9-… https://do…\n2  2018 Research Payment… All resear… 2025-01-30 2018-01… 7b82fb48-… https://do…\n3  2019 Research Payment… All resear… 2025-01-30 2019-01… 713a6016-… https://do…\n4  2020 Research Payment… All resear… 2025-01-30 2020-01… 9c248e7e-… https://do…\n5  2021 Research Payment… All resear… 2025-01-30 2021-01… ce1d28dd-… https://do…\n6  2022 Research Payment… All resear… 2025-01-30 2022-01… fdc3c773-… https://do…\n7  2023 Research Payment… All resear… 2025-01-30 2023-01… ec9521bf-… https://do…\n\n$ownership\n# A tibble: 7 × 7\n   year title             description modified   temporal identifier downloadURL\n  <int> <chr>             <chr>       <date>     <chr>    <chr>      <chr>      \n1  2017 Ownership Paymen… All owners… 2025-01-30 2017-01… f90c33d1-… https://do…\n2  2018 Ownership Paymen… All owners… 2025-01-30 2018-01… de0087e0-… https://do…\n3  2019 Ownership Paymen… All owners… 2025-01-30 2019-01… 0b5c9710-… https://do…\n4  2020 Ownership Paymen… All owners… 2025-01-30 2020-01… a9a0bf48-… https://do…\n5  2021 Ownership Paymen… All owners… 2025-01-30 2021-01… b0c03b8d-… https://do…\n6  2022 Ownership Paymen… All owners… 2025-01-30 2022-01… 37792388-… https://do…\n7  2023 Ownership Paymen… All owners… 2025-01-30 2023-01… ac0bc85c-… https://do…\n\n$dictionary\n                                                                                                          describedBy\n1 https://openpaymentsdata.cms.gov/api/1/metastore/schemas/data-dictionary/items/618ebb0f-b9c8-5efd-a374-bd8e7665d5f8\n2 https://openpaymentsdata.cms.gov/api/1/metastore/schemas/data-dictionary/items/0b7b03cb-835c-50c4-abbb-5a311eb91858\n3 https://openpaymentsdata.cms.gov/api/1/metastore/schemas/data-dictionary/items/71ec19df-f5ef-5b99-b43b-e566e22670b7\n4 https://openpaymentsdata.cms.gov/api/1/metastore/schemas/data-dictionary/items/80796264-d7e9-57cd-8133-2a2a14b1647b\n                                  name\n1                Research Payment Data\n2               Ownership Payment Data\n3                 General Payment Data\n4 Covered Recipient Profile Supplement\n```\n\n\n:::\n:::\n\n### Summary Group\n\n::: {.cell}\n\n```{.r .cell-code}\nopenpay$summary_all |> \n  print(n = Inf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 18 × 6\n   title                  description modified   temporal identifier downloadURL\n   <chr>                  <chr>       <date>     <chr>    <chr>      <chr>      \n 1 Covered Recipient Pro… The Covere… 2025-01-30 2017-01… 23160558-… https://do…\n 2 National Level Paymen… This datas… 2025-01-30 2017-01… 04c3355f-… https://do…\n 3 National Level Paymen… This datas… 2025-01-30 2017-01… aaaddc12-… https://do…\n 4 Payments Grouped by C… This datas… 2025-01-30 2017-01… 8d4d1fa0-… https://do…\n 5 Payments Grouped by C… This datas… 2025-01-30 2017-01… e49defac-… https://do…\n 6 Payments Grouped by P… This datas… 2025-01-30 2017-01… 895260f5-… https://do…\n 7 Payments Grouped by R… This datas… 2025-01-30 2017-01… d5762bed-… https://do…\n 8 Payments Grouped by R… This datas… 2025-01-30 2017-01… 61efcbef-… https://do…\n 9 Payments Grouped by R… This datas… 2025-01-30 2017-01… ea5eea39-… https://do…\n10 Payments Grouped by T… This datas… 2025-01-30 2017-01… 217ad1a7-… https://do…\n11 Physician (Distinct) … This datas… 2025-01-30 <NA>     6ed6ae76-… https://do…\n12 Profile Information    This datas… 2025-01-30 <NA>     f2ed17cc-… https://do…\n13 Provider Profile ID M… Maps secon… 2025-01-30 2017-01… d19e5be2-… https://do…\n14 Reporting Entity Prof… This datas… 2025-01-30 <NA>     1cf0c6c0-… https://do…\n15 State Level Payment T… This datas… 2025-01-30 2017-01… 02157882-… https://do…\n16 State Payment Totals … Groups pay… 2025-01-30 2022-01… 7c5144d9-… https://do…\n17 Summary Dashboard - a… Summary da… 2025-01-30 2017-01… e0d225fc-… https://do…\n18 Teaching Hospital Pro… This datas… 2025-01-30 <NA>     8219fcb3-… https://do…\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nopenpay$summary_year |> \n  rsplit(~ title)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$`Payments Grouped by Covered Recipient and Nature of Payments`\n# A tibble: 7 × 6\n   year description                   modified   temporal identifier downloadURL\n  <int> <chr>                         <date>     <chr>    <chr>      <chr>      \n1  2023 This dataset is pre-filtered… 2025-01-30 2023-01… 4017acfa-… https://do…\n2  2022 This dataset is pre-filtered… 2025-01-30 2022-01… 686b765e-… https://do…\n3  2021 This dataset is pre-filtered… 2025-01-30 2021-01… d35243be-… https://do…\n4  2020 This dataset is pre-filtered… 2025-01-30 2020-01… 1fd2be47-… https://do…\n5  2019 This dataset is pre-filtered… 2025-01-30 2019-01… 0ff0961f-… https://do…\n6  2018 This dataset is pre-filtered… 2025-01-30 2018-01… 07c1e377-… https://do…\n7  2017 This dataset is pre-filtered… 2025-01-30 2017-01… 5aad28fa-… https://do…\n\n$`Payments Grouped by Covered Recipient and Reporting Entities`\n# A tibble: 7 × 6\n   year description                   modified   temporal identifier downloadURL\n  <int> <chr>                         <date>     <chr>    <chr>      <chr>      \n1  2023 This dataset is pre-filtered… 2025-01-30 2023-01… 4fbf0094-… https://do…\n2  2022 This dataset is pre-filtered… 2025-01-30 2022-01… d2d87f39-… https://do…\n3  2021 This dataset is pre-filtered… 2025-01-30 2021-01… 7c9ebb83-… https://do…\n4  2020 This dataset is pre-filtered… 2025-01-30 2020-01… 78ad9c8d-… https://do…\n5  2019 This dataset is pre-filtered… 2025-01-30 2019-01… 63c6fc23-… https://do…\n6  2018 This dataset is pre-filtered… 2025-01-30 2018-01… b6f534a9-… https://do…\n7  2017 This dataset is pre-filtered… 2025-01-30 2017-01… 120f42a3-… https://do…\n\n$`Payments Grouped by Reporting Entities and Nature of Payments`\n# A tibble: 7 × 6\n   year description                   modified   temporal identifier downloadURL\n  <int> <chr>                         <date>     <chr>    <chr>      <chr>      \n1  2023 This dataset is pre-filtered… 2025-01-30 2023-01… 72008dab-… https://do…\n2  2022 This dataset is pre-filtered… 2025-01-30 2022-01… cedcd327-… https://do…\n3  2021 This dataset is pre-filtered… 2025-01-30 2021-01… a2714020-… https://do…\n4  2020 This dataset is pre-filtered… 2025-01-30 2020-01… 7dfe6254-… https://do…\n5  2019 This dataset is pre-filtered… 2025-01-30 2019-01… 7f3bcc65-… https://do…\n6  2018 This dataset is pre-filtered… 2025-01-30 2018-01… 76d91818-… https://do…\n7  2017 This dataset is pre-filtered… 2025-01-30 2017-01… 8ab7b1de-… https://do…\n\n$`Payments Grouped by Reporting Entities, Covered Recipient, and Nature of Payments`\n# A tibble: 7 × 6\n   year description                   modified   temporal identifier downloadURL\n  <int> <chr>                         <date>     <chr>    <chr>      <chr>      \n1  2023 This dataset is pre-filtered… 2025-01-30 2023-01… 29c23b6a-… https://do…\n2  2022 This dataset is pre-filtered… 2025-01-30 2022-01… 171e369a-… https://do…\n3  2021 This dataset is pre-filtered… 2025-01-30 2021-01… f240c437-… https://do…\n4  2020 This dataset is pre-filtered… 2025-01-30 2020-01… 532df191-… https://do…\n5  2019 This dataset is pre-filtered… 2025-01-30 2019-01… 6c8251d4-… https://do…\n6  2018 This dataset is pre-filtered… 2025-01-30 2018-01… c1ce263b-… https://do…\n7  2017 This dataset is pre-filtered… 2025-01-30 2017-01… d3d4880a-… https://do…\n\n$`State Payment Totals Grouped by Nature of Payment for all Years`\n# A tibble: 7 × 6\n   year description                   modified   temporal identifier downloadURL\n  <int> <chr>                         <date>     <chr>    <chr>      <chr>      \n1  2023 Groups payment data by state… 2025-01-30 2023-01… f83aed3a-… https://do…\n2  2022 Groups payment data by state… 2025-01-30 2022-01… c64c40af-… https://do…\n3  2021 Groups payment data by state… 2025-01-30 2021-01… 7fad5b56-… https://do…\n4  2020 Groups payment data by state… 2025-01-30 2020-01… 7f3055b6-… https://do…\n5  2019 Groups payment data by state… 2025-01-30 2019-01… 37fba404-… https://do…\n6  2018 Groups payment data by state… 2025-01-30 2018-01… 6dd14c90-… https://do…\n7  2017 Groups payment data by state… 2025-01-30 2017-01… 4013f179-… https://do…\n```\n\n\n:::\n:::\n\n\n## Dictionaries\n\n::: {.cell}\n\n```{.r .cell-code}\nopen_dictionary <- function(x, nm) {\n  \n  nm <- arg_match0(nm, c(\"Covered\", \"Research\", \"Ownership\", \"General\"))  \n  \n  x <- sbt(x$dictionary, \n           stri_detect_regex(name, paste0(\"^\", nm))) |> \n    _[[\"describedBy\"]] |> \n    request() |> \n    req_perform() |> \n    resp_simple_json() |> \n    as_tbl() |> \n    _[[\"data\"]]\n  \n  roworder(\n    new_tbl(\n      field = delist(get_elem(x$fields, \"name\")),\n      description = delist(get_elem(x$fields, \"description\"))), \n    field)\n}\n```\n:::\n\n### Covered Recipient Profile Supplement\n\n::: {.cell}\n\n```{.r .cell-code}\nopen_dictionary(openpay, \"Covered\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 32 × 2\n   field                                           description                  \n   <chr>                                           <chr>                        \n 1 associated_covered_recipient_profile_id_1       \"Covered_Recipient_Profile_I…\n 2 associated_covered_recipient_profile_id_2       \"Covered_Recipient_Profile_I…\n 3 covered_recipient_npi                           \"National Provider Identifie…\n 4 covered_recipient_profile_address_line_1        \"The first line of latest “P…\n 5 covered_recipient_profile_address_line_2        \"The second line of latest “…\n 6 covered_recipient_profile_alternate_first_name  \"The alternate first name as…\n 7 covered_recipient_profile_alternate_last_name   \"The alternate last name as …\n 8 covered_recipient_profile_alternate_middle_name \"The alternate middle name a…\n 9 covered_recipient_profile_alternate_suffix      \"The alternate suffix as ava…\n10 covered_recipient_profile_city                  \"The city of the latest “Pro…\n# ℹ 22 more rows\n```\n\n\n:::\n:::\n\n### General Payment File\n\n::: {.cell}\n\n```{.r .cell-code}\nopen_dictionary(openpay, \"General\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 91 × 2\n   field                                                            description \n   <chr>                                                            <chr>       \n 1 applicable_manufacturer_or_applicable_gpo_making_payment_country \"Country na…\n 2 applicable_manufacturer_or_applicable_gpo_making_payment_id      \"System gen…\n 3 applicable_manufacturer_or_applicable_gpo_making_payment_name    \"The textua…\n 4 applicable_manufacturer_or_applicable_gpo_making_payment_state   \"State name…\n 5 associated_device_or_medical_supply_pdi_1                        \"The Primar…\n 6 associated_device_or_medical_supply_pdi_2                        \"The Primar…\n 7 associated_device_or_medical_supply_pdi_3                        \"The Primar…\n 8 associated_device_or_medical_supply_pdi_4                        \"The Primar…\n 9 associated_device_or_medical_supply_pdi_5                        \"The Primar…\n10 associated_drug_or_biological_ndc_1                              \"The Nation…\n# ℹ 81 more rows\n```\n\n\n:::\n:::\n\n### Ownership Payment File\n\n::: {.cell}\n\n```{.r .cell-code}\nopen_dictionary(openpay, \"Ownership\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 30 × 2\n   field                                                            description \n   <chr>                                                            <chr>       \n 1 applicable_manufacturer_or_applicable_gpo_making_payment_country \"Country na…\n 2 applicable_manufacturer_or_applicable_gpo_making_payment_id      \"Open Payme…\n 3 applicable_manufacturer_or_applicable_gpo_making_payment_name    \"The textua…\n 4 applicable_manufacturer_or_applicable_gpo_making_payment_state   \"State name…\n 5 change_type                                                      \"An indicat…\n 6 dispute_status_for_publication                                   \"Indicates …\n 7 interest_held_by_physician_or_an_immediate_family_member         \"An indicat…\n 8 payment_publication_date                                         \"The predef…\n 9 physician_first_name                                             \"First name…\n10 physician_last_name                                              \"Last name …\n# ℹ 20 more rows\n```\n\n\n:::\n:::\n\n### Ownership Payment File\n\n::: {.cell}\n\n```{.r .cell-code}\nopen_dictionary(openpay, \"Research\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 252 × 2\n   field                                                            description \n   <chr>                                                            <chr>       \n 1 applicable_manufacturer_or_applicable_gpo_making_payment_country \"Country na…\n 2 applicable_manufacturer_or_applicable_gpo_making_payment_id      \"System gen…\n 3 applicable_manufacturer_or_applicable_gpo_making_payment_name    \"Textual pr…\n 4 applicable_manufacturer_or_applicable_gpo_making_payment_state   \"State name…\n 5 associated_device_or_medical_supply_pdi_1                        \"The Primar…\n 6 associated_device_or_medical_supply_pdi_2                        \"The Primar…\n 7 associated_device_or_medical_supply_pdi_3                        \"The Primar…\n 8 associated_device_or_medical_supply_pdi_4                        \"The Primar…\n 9 associated_device_or_medical_supply_pdi_5                        \"The Primar…\n10 associated_drug_or_biological_ndc_1                              \"The Nation…\n# ℹ 242 more rows\n```\n\n\n:::\n:::\n",
    "supporting": [
      "faq_openpay_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}