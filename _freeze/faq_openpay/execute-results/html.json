{
  "hash": "6525e1cf7bec239ab579f0aad5d8bd31",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Open Payments API\"\neditor_options: \n   chunk_output_type: console\n---\n\n\n## Dataset\n\n   * `publisher`: `\"openpaymentsdata.cms.gov\"`\n   * `bureauCode`: `\"009:38\"`\n   * `programCode`: `\"009:000\"`\n   * `\"accessLevel\"`: `\"public\"`\n\n::: {.cell}\n\n```{.r .cell-code}\nopen_dataset <- qTBL(\n  fload(\"https://openpaymentsdata.cms.gov/api/1/metastore/schemas/dataset/items?show-reference-ids\"), \n  keep.attr = TRUE) |>\n    mtt(issued             = as_date(issued),\n        modified           = as_date(modified),\n        accrualPeriodicity = recode_iso8601(accrualPeriodicity),\n        description        = sf_remove(description, \"\\n\"),\n        bureauCode         = delist(bureauCode),\n        programCode        = delist(programCode),\n        theme              = delist(map(theme, \\(x) gelm(as.list(x), \"data\"))),\n        year               = delist(map(keyword, \\(x) gelm(as.list(x), \"data\"))),\n        `%modified`        = clock::date_time_parse_RFC_3339(`%modified`, offset = \"%Ez\")) |> \n  slt(year,\n      title,\n      description,\n      theme,\n      issued,\n      modified,\n      modified_dttm = `%modified`,\n      temporal,\n      accrualPeriodicity,\n      distribution)\n```\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# identifiers <- uniq(qTBL(rowbind(gelm(open_dataset, \"keyword\"))))\n```\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nidentifier <- qTBL(rowbind(gelm(open_dataset, \"distribution\"), fill = TRUE), keep.attr = TRUE)\n\nidentifier\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 74 × 2\n   identifier                           data            \n   <chr>                                <list>          \n 1 10ec915a-726a-53b1-9eee-546846c90a60 <named list [7]>\n 2 74072985-5917-5079-a3f4-a0da51425bf8 <named list [7]>\n 3 972fcce6-f7d1-5be0-9241-863086d2480f <named list [7]>\n 4 bfb00fa2-35de-5252-af36-3792394e0f4d <named list [7]>\n 5 e8e70351-162d-5ef6-b1ac-2ee76547596c <named list [7]>\n 6 ce9b904c-ba82-538d-aa58-8aaf403485c7 <named list [7]>\n 7 6817039d-2e36-5f2f-a39a-ff06348fde9d <named list [7]>\n 8 76157bd1-ad0c-5013-8507-7d1d60c8704c <named list [7]>\n 9 9604af6a-476a-5106-ac01-9a0fb7749e01 <named list [7]>\n10 d3d56ac4-0d97-5e8f-986c-eb577ff5086a <named list [7]>\n# ℹ 64 more rows\n```\n\n\n:::\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndistribution <- qTBL(rowbind(gelm(identifier, \"data\"), fill = TRUE), keep.attr = TRUE) |> \n  slt(-`@type`)\n\ndistribution |> \n  select(`%Ref:downloadURL`) |> \n  unnest_wider(`%Ref:downloadURL`, names_sep = \"_\") |> \n  head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 148\n  `%Ref:downloadURL_1`                 `%Ref:downloadURL_2` `%Ref:downloadURL_3`\n  <chr>                                        <list<list>> <chr>               \n1 406c2298a6b7301216c629a77526e892__1…                  [1] 8ceb3ee081ecd373992…\n2 406c2298a6b7301216c629a77526e892__1…                  [1] 8ceb3ee081ecd373992…\n3 406c2298a6b7301216c629a77526e892__1…                  [1] 8ceb3ee081ecd373992…\n4 406c2298a6b7301216c629a77526e892__1…                  [1] 8ceb3ee081ecd373992…\n5 406c2298a6b7301216c629a77526e892__1…                  [1] 8ceb3ee081ecd373992…\n6 406c2298a6b7301216c629a77526e892__1…                  [1] 8ceb3ee081ecd373992…\n# ℹ 145 more variables: `%Ref:downloadURL_4` <list<list>>,\n#   `%Ref:downloadURL_5` <chr>, `%Ref:downloadURL_6` <list<list>>,\n#   `%Ref:downloadURL_7` <chr>, `%Ref:downloadURL_8` <list<list>>,\n#   `%Ref:downloadURL_9` <chr>, `%Ref:downloadURL_10` <list<list>>,\n#   `%Ref:downloadURL_11` <chr>, `%Ref:downloadURL_12` <list<list>>,\n#   `%Ref:downloadURL_13` <chr>, `%Ref:downloadURL_14` <list<list>>,\n#   `%Ref:downloadURL_15` <chr>, `%Ref:downloadURL_16` <list<list>>, …\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# qTBL(distribution[[\"%Ref:downloadURL\"]])\n# qTBL(rowbind(, fill = TRUE), keep.attr = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nopen_data <- request(\n  \"https://openpaymentsdata.cms.gov/api/1/metastore/schemas/dataset/items?show-reference-ids\"\n  ) |>\n  req_perform() |>\n  resp_body_json(simplifyVector = TRUE) |> \n  tibble() |> \n  unnest_wider(keyword, names_sep = \"_\") |>\n  unnest_wider(theme, names_sep = \"_\") |>\n  unnest_wider(contactPoint, names_sep = \"_\") |>\n  unnest_wider(publisher, names_sep = \"_\") |> \n  unnest_wider(publisher_data, names_sep = \"_\") |> \n  unnest_wider(distribution, names_sep = \"_\") |> \n  unnest_wider(distribution_data, names_sep = \"_\") |> \n  unnest_wider(`distribution_data_%Ref:downloadURL`, names_sep = \"_\") |> \n  unnest_wider(`distribution_data_%Ref:downloadURL_1`, names_sep = \"_\") |> \n  unnest_wider(`distribution_data_%Ref:downloadURL_1_data`, names_sep = \"_\") |> \n  mutate(\n    description        = replace_open_desc(description),\n    bureauCode         = delist(bureauCode),\n    programCode        = delist(programCode)) |>\n  rename_with(remove_at_symbol) |> \n  rename(modified_dttm = `%modified`) |> \n  remove_all_na()\n\nopen_data |> \n  purse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- $bureauCode                                            c74 009:38         ...\n- $programCode                                           c74 009:000        ...\n- $accessLevel                                           c74 public         ...\n- $keyword_identifier                                    c74 7a69eb60-9b96- ...\n- $keyword_data                                          c74 2017           ...\n- $contactPoint_fn                                       c74 Open Payments  ...\n- $contactPoint_hasEmail                                 c74 mailto:openpay ...\n- $dataQuality                                           l74 T              ...\n- $description                                           c74 Research Payme ...\n- $distribution_identifier                               c74 10ec915a-726a- ...\n- $distribution_data_title                               c74 Research Payme ...\n- $distribution_data_mediaType                           c74 text/csv       ...\n- $distribution_data_format                              c74 csv            ...\n- $distribution_data_downloadURL                         c74 https://downlo ...\n- $distribution_data_describedBy                         c74 https://openpa ...\n- $distribution_data_describedByType                     c74 application/vn ...\n- $distribution_data_%Ref:downloadURL_1_identifier       c74 406c2298a6b730 ...\n- $distribution_data_%Ref:downloadURL_1_data_filePath    c74 https://downlo ...\n- $distribution_data_%Ref:downloadURL_1_data_identifier  c74 406c2298a6b730 ...\n- $distribution_data_%Ref:downloadURL_1_data_mimeType    c74 text/csv       ...\n- $distribution_data_%Ref:downloadURL_1_data_perspective c74 source         ...\n- $distribution_data_%Ref:downloadURL_1_data_version     c74 1718422528     ...\n- $distribution_data_type                                c74 NA             ...\n- $identifier                                            c74 0e3977b9-a5d6- ...\n- $title                                                 c74 2017 Research  ...\n- $issued                                                c74 2024-06-28     ...\n- $modified                                              c74 2024-06-28     ...\n- $temporal                                              c74 2017-01-01/201 ...\n- $publisher_identifier                                  c74 11b41668-9929- ...\n- $publisher_data_name                                   c74 openpaymentsda ...\n- $publisher_data_type                                   c74 NA             ...\n- $license                                               c74 https://www.us ...\n- $theme_identifier                                      c74 0dbaba68-b7d1- ...\n- $theme_data                                            c74 Research Payme ...\n- $modified_dttm                                         c74 2024-07-29T20: ...\n- $type                                                  c74 NA             ...\n- $accrualPeriodicity                                    c74 NA             ...\n```\n\n\n:::\n:::\n",
    "supporting": [
      "faq_openpay_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}