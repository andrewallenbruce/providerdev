{
  "hash": "4bef2c0c3022d534f0258950b04d4089",
  "result": {
    "engine": "knitr",
    "markdown": "---\noutput: html_document\neditor_options: \n  chunk_output_type: console\n---\n# Geospatial {#sec-demogeo}\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunderscore <- \\(x) gsub(\"___owner$\", \"\", x, perl = TRUE)\nchar_binary <- \\(x) val_match(x, \"N\" ~ 0L, \"Y\" ~ 1L)\npct_prop <- \\(x) {\n  cheapr::case(\n    x == \"0\" ~ 0,\n    cheapr::is_na(x) ~ NA_real_,\n    .default = as.double(x) / 100\n  )\n}\n```\n:::\n\n## Load Packages\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidygeocoder)\nlibrary(tigris)\nlibrary(rmapshaper)\nlibrary(sf)\noptions(tigris_use_cache = TRUE)\n```\n:::\n\n## Rural Health Clinics\n\n::: {.cell}\n\n```{.r .cell-code}\nreq <- careGroup(\"rural_health\")@groups |>\n  _[[\"rural_health_clinic_enrollments\"]] |>\n  _[[\"endpoints\"]] |>\n  _[[\"identifier\"]] |>\n  request() |> \n  req_url_query(\n    \"filter[STATE]\" = \"GA\"\n  )\n\nnres <- req |> \n  req_url_path_append(\"stats\") |>\n  providertwo:::perform_simple() |> \n  _[[\"data\"]] |> \n  _[[\"found_rows\"]]\n\nres <- req |> \n  req_url_query(offset = 0L, size = 5000L) |> \n  req_perform() |> \n  providertwo:::resp_simple_json() |> \n  get_elem(\"^data$|headers\", regex = TRUE)\n\nrhc_enr <- as_tbl(res$data) |> \n  set_names(res$meta) |> \n  providertwo:::map_na_if() |> \n  roworder(`ORGANIZATION NAME`) |>\n  janitor::clean_names() |>\n  mtt(incorporation_date = providertwo:::as_date(incorporation_date),\n      multiple_npi_flag = char_binary(multiple_npi_flag),\n      address = cheapr_if_else(\n        cheapr::is_na(address_line_2), \n        address_line_1, \n        paste(address_line_1, address_line_2))) |>\n  slt(\n    npi,\n    has_mult_npi = multiple_npi_flag,\n    ccn,\n    pac = associate_id,\n    enid = enrollment_id,\n    enid_state = enrollment_state,\n    org_name = organization_name,\n    dba_name = doing_business_as_name,\n    inc_date = incorporation_date,\n    inc_state = incorporation_state,\n    org_type = organization_type_structure,\n    org_type_2 = organization_other_type_text,\n    proprietary_nonprofit,\n    address,\n    city,\n    state,\n    zip = zip_code)\n\n\nrhc_enr |> \n  purse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> - $npi                   c85 1639774714                        1174104657   ...\n#> - $has_mult_npi          i85 0                                 0            ...\n#> - $ccn                   c85 118915                            118917       ...\n#> - $pac                   c85 2961814694                        2961814694   ...\n#> - $enid                  c85 O20210409001138                   O20211123003 ...\n#> - $enid_state            c85 GA                                GA           ...\n#> - $org_name              c85 ACCESS MEDICAL CLINIC GEORGIA LLC ACCESS MEDIC ...\n#> - $dba_name              c85 NA                                NA           ...\n#> - $inc_date              D85 2020-07-29                        2021-01-11   ...\n#> - $inc_state             c85 GA                                GA           ...\n#> - $org_type              c85 LLC                               LLC          ...\n#> - $org_type_2            c85 NA                                NA           ...\n#> - $proprietary_nonprofit c85 P                                 P            ...\n#> - $address               c85 304 N WESTBERRY ST                37 341 BYP   ...\n#> - $city                  c85 SYLVESTER                         HAWKINSVILLE ...\n#> - $state                 c85 GA                                GA           ...\n#> - $zip                   c85 317912125                         310364839    ...\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nreq <- careGroup(\"rural_health\")@groups |>\n  _[[\"rural_health_clinic_all_owners\"]] |> \n  _[[\"endpoints\"]] |>\n  _[[\"identifier\"]] |>\n  request() |> \n  req_url_query(\"filter[STATE - OWNER]\" = \"GA\")\n\nnres <- req |> \n  req_url_path_append(\"stats\") |>\n  providertwo:::perform_simple() |> \n  _[[\"data\"]] |> \n  _[[\"found_rows\"]]\n\nres <- req |> \n  req_url_query(offset = 0L, size = 5000L) |> \n  req_perform() |> \n  providertwo:::resp_simple_json() |> \n  get_elem(\"^data$|headers\", regex = TRUE)\n\nrhc_owner <- as_tbl(res$data) |> \n  set_names(res$meta) |> \n  providertwo:::map_na_if() |> \n  janitor::clean_names() |> \n  rnm(\n    enid = enrollment_id,\n    pac = associate_id_owner, \n    org_name = organization_name) |>\n  mtt(\n    association_date = providertwo:::as_date(association_date_owner),\n    address = cheapr_if_else(cheapr::is_na(address_line_2_owner), address_line_1_owner, paste(address_line_1_owner, address_line_2_owner)),\n    percentage_ownership = as.numeric(percentage_ownership),\n    role_code = as.integer(role_code_owner)\n  ) |>\n  slt(\n    pac,\n    enid,\n    org_name,\n    pac_owner = associate_id, \n    org_name_owner = organization_name_owner,\n    entity = type_owner,\n    role_code,\n    role_text = role_text_owner,\n    association_date_owner,\n    first_name_owner,\n    middle_name_owner,\n    last_name_owner,\n    title_owner,\n    dba_name = doing_business_as_name_owner,\n    address,\n    city_owner,\n    state_owner,\n    zip = zip_code_owner,\n    percentage_ownership,\n    is_for_acq = created_for_acquisition_owner,\n    is_corp = corporation_owner,\n    is_llc = llc_owner,\n    is_med_prov_supp = medical_provider_supplier_owner,\n    is_mgmt_serv_co = management_services_company_owner,\n    is_med_staff_co = medical_staffing_company_owner,\n    is_holding_co = holding_company_owner,\n    is_invest_firm = investment_firm_owner,\n    is_fin_inst = financial_institution_owner,\n    is_consult_firm = consulting_firm_owner,\n    is_for_profit = for_profit_owner,\n    is_non_profit = non_profit_owner,\n    is_other_type = other_type_owner,\n    other_type = other_type_text_owner\n  ) |> \n  mtt(\n    is_for_acq = char_binary(is_for_acq),\n    is_corp = char_binary(is_corp),\n    is_llc = char_binary(is_llc),\n    is_med_prov_supp = char_binary(is_med_prov_supp),\n    is_mgmt_serv_co = char_binary(is_mgmt_serv_co),\n    is_med_staff_co = char_binary(is_med_staff_co),\n    is_holding_co = char_binary(is_holding_co),\n    is_invest_firm = char_binary(is_invest_firm),\n    is_fin_inst = char_binary(is_fin_inst),\n    is_consult_firm = char_binary(is_consult_firm),\n    is_for_profit = char_binary(is_for_profit),\n    is_non_profit = char_binary(is_non_profit),\n    is_other_type = char_binary(is_other_type)\n  )\n\nrhc_owner\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> # A tibble: 86 × 33\n#>    pac        enid  org_name pac_owner org_name_owner entity role_code role_text\n#>    <chr>      <chr> <chr>    <chr>     <chr>          <chr>      <int> <chr>    \n#>  1 0547179665 O200… TMC HAR… 87299978… TMC/HIGGINS G… O             34 5% OR GR…\n#>  2 1557271731 O200… HIAWASS… 15572717… HIAWASSEE FAM… O             43 OPERATIO…\n#>  3 5991616039 O200… TMC WES… 59916160… TMC WEST CARR… O             34 5% OR GR…\n#>  4 1850294034 O200… BACON C… 18502940… BACON COUNTY … O             34 5% OR GR…\n#>  5 1850294034 O200… BACON C… 18502940… BACON COUNTY … O             43 OPERATIO…\n#>  6 2264415538 O200… BOWDON-… 22644155… BOWDON- MT. Z… O             36 5% OR GR…\n#>  7 2264415538 O200… BOWDON-… 22644155… BOWDON- MT. Z… O             43 OPERATIO…\n#>  8 4981502622 O200… HOSPITA… 60027245… JOHN D. ARCHB… O             43 OPERATIO…\n#>  9 4981502622 O200… HOSPITA… 60027245… JOHN D. ARCHB… O             43 OPERATIO…\n#> 10 4183529183 O200… PHOEBE … 08401045… PHOEBE PUTNEY… O             34 5% OR GR…\n#> # ℹ 76 more rows\n#> # ℹ 25 more variables: association_date_owner <chr>, first_name_owner <chr>,\n#> #   middle_name_owner <chr>, last_name_owner <chr>, title_owner <chr>,\n#> #   dba_name <chr>, address <chr>, city_owner <chr>, state_owner <chr>,\n#> #   zip <chr>, percentage_ownership <dbl>, is_for_acq <int>, is_corp <int>,\n#> #   is_llc <int>, is_med_prov_supp <int>, is_mgmt_serv_co <int>,\n#> #   is_med_staff_co <int>, is_holding_co <int>, is_invest_firm <int>, …\n```\n\n\n:::\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntictoc::tic()\nrhc_nppes <- npi_nppes(npi = rhc_enr$npi)\ntictoc::toc()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> 1.13 sec elapsed\n```\n\n\n:::\n\n```{.r .cell-code}\nrhc_nppes |> \n  slt(-endpoints, -enumeration_type) |> \n  print(n = 100)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> # A tibble: 85 × 7\n#>    number     addresses    practiceLocations basic        taxonomies identifiers\n#>    <chr>      <list>       <list>            <list>       <list>     <list>     \n#>  1 1639774714 <df>         <NULL>            <named list> <df>       <NULL>     \n#>  2 1174104657 <df>         <NULL>            <named list> <df>       <NULL>     \n#>  3 1568100519 <df>         <NULL>            <named list> <df>       <NULL>     \n#>  4 1821017831 <df>         <NULL>            <named list> <df>       <df>       \n#>  5 1558898882 <df>         <NULL>            <named list> <df>       <NULL>     \n#>  6 1750339511 <df>         <NULL>            <named list> <df>       <df>       \n#>  7 1417906348 <df>         <NULL>            <named list> <df>       <df>       \n#>  8 1538117932 <df>         <NULL>            <named list> <df>       <df>       \n#>  9 1851969372 <df [2 × 9]> <NULL>            <named list> <df>       <NULL>     \n#> 10 1639211956 <df>         <NULL>            <named list> <df>       <df>       \n#> 11 1881758753 <df>         <NULL>            <named list> <df>       <df>       \n#> 12 1790992352 <df>         <NULL>            <named list> <df>       <df>       \n#> 13 1376750976 <df>         <NULL>            <named list> <df>       <df>       \n#> 14 1427333095 <df>         <NULL>            <named list> <df>       <df>       \n#> 15 1821662008 <df [2 × 9]> <NULL>            <named list> <df>       <NULL>     \n#> 16 1922672120 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 17 1255948717 <df>         <NULL>            <named list> <df>       <df>       \n#> 18 1811020407 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 19 1750686382 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 20 1700237633 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 21 1063832202 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 22 1437577350 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 23 1366784415 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 24 1912319997 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 25 1538586243 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 26 1285706879 <df>         <NULL>            <named list> <df>       <df>       \n#> 27 1790088169 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 28 1912379082 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 29 1699782037 <df>         <NULL>            <named list> <df>       <df>       \n#> 30 1215943915 <df>         <NULL>            <named list> <df>       <df>       \n#> 31 1801801543 <df>         <NULL>            <named list> <df>       <df>       \n#> 32 1366472003 <df>         <NULL>            <named list> <df>       <df>       \n#> 33 1922211515 <df>         <NULL>            <named list> <df>       <df>       \n#> 34 1881960151 <df [2 × 9]> <NULL>            <named list> <df>       <NULL>     \n#> 35 1801128863 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 36 1023332970 <df>         <NULL>            <named list> <df>       <df>       \n#> 37 1649670894 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 38 1912430224 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 39 1063459899 <df>         <NULL>            <named list> <df>       <df>       \n#> 40 1851334015 <df>         <NULL>            <named list> <df>       <df>       \n#> 41 1467602482 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 42 1760632780 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 43 1912564618 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 44 1518398049 <df>         <NULL>            <named list> <df>       <df>       \n#> 45 1780695775 <df>         <NULL>            <named list> <df>       <df>       \n#> 46 1275714438 <df>         <NULL>            <named list> <df>       <df>       \n#> 47 1376778001 <df>         <NULL>            <named list> <df>       <df>       \n#> 48 1891770764 <df>         <NULL>            <named list> <df>       <df>       \n#> 49 1659700763 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 50 1053802553 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 51 1386339141 <df [2 × 9]> <NULL>            <named list> <df>       <NULL>     \n#> 52 1841432044 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 53 1033428214 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 54 1811233828 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 55 1386708154 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 56 1649853862 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 57 1285893818 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 58 1972762508 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 59 1285132415 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 60 1568713873 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 61 1720227895 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 62 1073752143 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 63 1255570321 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 64 1740778828 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 65 1528110103 <df>         <NULL>            <named list> <df>       <df>       \n#> 66 1235227752 <df>         <NULL>            <named list> <df>       <df>       \n#> 67 1083816128 <df>         <NULL>            <named list> <df>       <df>       \n#> 68 1891863569 <df>         <NULL>            <named list> <df>       <df>       \n#> 69 1275775314 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 70 1871816918 <df>         <df [1 × 10]>     <named list> <df>       <df>       \n#> 71 1487284956 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 72 1861022329 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 73 1063042562 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 74 1588294045 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 75 1649800111 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 76 1508801416 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 77 1992710610 <df>         <NULL>            <named list> <df>       <df>       \n#> 78 1497760243 <df>         <NULL>            <named list> <df>       <df>       \n#> 79 1982631321 <df>         <NULL>            <named list> <df>       <df>       \n#> 80 1578682696 <df [2 × 9]> <NULL>            <named list> <df>       <df>       \n#> 81 1427384353 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 82 1144276452 <df>         <NULL>            <named list> <df>       <NULL>     \n#> 83 1700392438 <df>         <NULL>            <named list> <df>       <df>       \n#> 84 1174024665 <df [2 × 9]> <NULL>            <named list> <df>       <NULL>     \n#> 85 1629531694 <df [2 × 9]> <NULL>            <named list> <df>       <NULL>     \n#> # ℹ 1 more variable: other_names <list>\n```\n\n\n:::\n\n```{.r .cell-code}\nrhc_nppes |> \n  slt(number, addresses) |> \n  unnest(addresses) |> \n  mtt(address = cheapr_if_else(cheapr::is_na(address_2), address_1, paste(address_1, address_2))) |> \n  slt(-address_1, -address_2, -address_type, -country_code, -country_name)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> # A tibble: 170 × 8\n#>    number    address_purpose city  state postal_code telephone_number fax_number\n#>    <chr>     <chr>           <chr> <chr> <chr>       <chr>            <chr>     \n#>  1 16397747… LOCATION        SYLV… GA    317912125   229-463-7071     833-606-0…\n#>  2 16397747… MAILING         HARDY AR    725428002   <NA>             <NA>      \n#>  3 11741046… LOCATION        HAWK… GA    310360000   478-845-4842     833-606-0…\n#>  4 11741046… MAILING         HARDY AR    725428002   <NA>             870-856-2…\n#>  5 15681005… LOCATION        BRUN… GA    315238285   870-856-1202     870-856-2…\n#>  6 15681005… MAILING         HARDY AR    725428002   870-856-1202     866-500-4…\n#>  7 18210178… MAILING         ALMA  GA    315102908   912-632-2952     912-632-8…\n#>  8 18210178… LOCATION        ALMA  GA    315102908   912-632-2952     912-632-8…\n#>  9 15588988… LOCATION        NICH… GA    31554       912-632-2952     <NA>      \n#> 10 15588988… MAILING         ALMA  GA    315102922   912-632-8961     912-632-5…\n#> # ℹ 160 more rows\n#> # ℹ 1 more variable: address <chr>\n```\n\n\n:::\n\n```{.r .cell-code}\nrhc_nppes |> \n  slt(number, basic) |> \n  unnest_wider(basic)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> # A tibble: 85 × 16\n#>    number organization_name organizational_subpart enumeration_date last_updated\n#>    <chr>  <chr>             <chr>                  <chr>            <chr>       \n#>  1 16397… ACCESS MEDICAL C… NO                     2020-12-04       2021-10-06  \n#>  2 11741… ACCESS MEDICAL C… NO                     2021-04-16       2022-09-13  \n#>  3 15681… ACCESS MEDICAL C… NO                     2022-05-20       2024-02-27  \n#>  4 18210… BACON COUNTY HEA… NO                     2006-07-19       2012-10-10  \n#>  5 15588… BACON COUNTY HEA… NO                     2017-05-17       2018-05-22  \n#>  6 17503… BOWDON- MT. ZION… YES                    2006-05-04       2022-02-21  \n#>  7 14179… BOWDENMTZION PRI… NO                     2006-05-08       2022-03-21  \n#>  8 15381… BOWDON- MT. ZION… NO                     2006-05-05       2023-02-28  \n#>  9 18519… BURKE HOSPITAL C… NO                     2021-06-11       2022-10-03  \n#> 10 16392… COFFEE REGIONAL … NO                     2007-02-13       2022-09-23  \n#> # ℹ 75 more rows\n#> # ℹ 11 more variables: certification_date <chr>, status <chr>,\n#> #   authorized_official_first_name <chr>, authorized_official_last_name <chr>,\n#> #   authorized_official_telephone_number <chr>,\n#> #   authorized_official_title_or_position <chr>,\n#> #   authorized_official_name_prefix <chr>,\n#> #   authorized_official_name_suffix <chr>, …\n```\n\n\n:::\n\n```{.r .cell-code}\nrhc_nppes |> \n  slt(number, taxonomies) |> \n  unnest(taxonomies)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> # A tibble: 156 × 7\n#>    number     code       taxonomy_group              desc  state license primary\n#>    <chr>      <chr>      <chr>                       <chr> <chr> <chr>   <lgl>  \n#>  1 1639774714 207Q00000X \"193200000X - Multi-Specia… Fami… <NA>  <NA>    FALSE  \n#>  2 1639774714 261QR1300X \"\"                          Clin… <NA>  <NA>    TRUE   \n#>  3 1174104657 207Q00000X \"193200000X - Multi-Specia… Fami… <NA>  <NA>    FALSE  \n#>  4 1174104657 261QR1300X \"\"                          Clin… <NA>  <NA>    TRUE   \n#>  5 1568100519 207Q00000X \"193200000X - Multi-Specia… Fami… <NA>  <NA>    FALSE  \n#>  6 1568100519 261QR1300X \"\"                          Clin… <NA>  <NA>    TRUE   \n#>  7 1821017831 282NR1301X \"\"                          Gene… <NA>  <NA>    TRUE   \n#>  8 1558898882 282NR1301X \"\"                          Gene… <NA>  <NA>    FALSE  \n#>  9 1558898882 363LF0000X \"193200000X - Multi-Specia… Nurs… <NA>  <NA>    TRUE   \n#> 10 1750339511 261QR1300X \"\"                          Clin… <NA>  <NA>    TRUE   \n#> # ℹ 146 more rows\n```\n\n\n:::\n\n```{.r .cell-code}\nrhc_nppes |> \n  slt(number, identifiers) |> \n  unnest(identifiers) |> \n  print(n = 100)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> # A tibble: 47 × 6\n#>    number     code  desc                 issuer                 identifier state\n#>    <chr>      <chr> <chr>                <chr>                  <chr>      <chr>\n#>  1 1821017831 05    MEDICAID             <NA>                   000000118C GA   \n#>  2 1821017831 01    Other (non-Medicare) Oscar Number           113408     GA   \n#>  3 1750339511 05    MEDICAID             <NA>                   000254064A GA   \n#>  4 1417906348 05    MEDICAID             <NA>                   000213749B GA   \n#>  5 1417906348 05    MEDICAID             <NA>                   000573262A GA   \n#>  6 1538117932 05    MEDICAID             <NA>                   000228588A GA   \n#>  7 1639211956 05    MEDICAID             <NA>                   00000448D  GA   \n#>  8 1881758753 05    MEDICAID             <NA>                   00002021D  GA   \n#>  9 1881758753 05    MEDICAID             <NA>                   00002021E  GA   \n#> 10 1790992352 05    MEDICAID             <NA>                   00000514F  GA   \n#> 11 1376750976 01    Other (non-Medicare) MCR CCN                11-8907    GA   \n#> 12 1427333095 05    MEDICAID             <NA>                   000548369c GA   \n#> 13 1255948717 05    MEDICAID             <NA>                   003257063A GA   \n#> 14 1285706879 05    MEDICAID             <NA>                   000195665I GA   \n#> 15 1285706879 05    MEDICAID             <NA>                   89011JU    NC   \n#> 16 1699782037 05    MEDICAID             <NA>                   000001031D GA   \n#> 17 1215943915 05    MEDICAID             <NA>                   000001031B GA   \n#> 18 1801801543 05    MEDICAID             <NA>                   000001031E GA   \n#> 19 1366472003 05    MEDICAID             <NA>                   000001339G GA   \n#> 20 1366472003 01    Other (non-Medicare) CLIA                   11D0909917 <NA> \n#> 21 1922211515 01    Other (non-Medicare) CLIA                   11D1056726 GA   \n#> 22 1922211515 05    MEDICAID             <NA>                   841859123C GA   \n#> 23 1023332970 05    MEDICAID             <NA>                   003110986A GA   \n#> 24 1063459899 05    MEDICAID             <NA>                   00700917A  GA   \n#> 25 1063459899 01    Other (non-Medicare) PALMETTO GBA RAILROAD  CE5080     GA   \n#> 26 1851334015 05    MEDICAID             <NA>                   00679775A  GA   \n#> 27 1851334015 01    Other (non-Medicare) PALMETTO GBA RAILROAD  CA6260     GA   \n#> 28 1518398049 05    MEDICAID             <NA>                   003155331A GA   \n#> 29 1518398049 01    Other (non-Medicare) Medicare Part A        11-8912    GA   \n#> 30 1780695775 01    Other (non-Medicare) RAILROAD MEDICARE      080137303  GA   \n#> 31 1275714438 01    Other (non-Medicare) RAILROAD MEDICARE      080137303  GA   \n#> 32 1376778001 05    MEDICAID             <NA>                   003112355A GA   \n#> 33 1891770764 05    MEDICAID             <NA>                   00002109E  GA   \n#> 34 1528110103 05    MEDICAID             <NA>                   0000014821 GA   \n#> 35 1235227752 05    MEDICAID             <NA>                   003140349A GA   \n#> 36 1083816128 05    MEDICAID             <NA>                   251066475A GA   \n#> 37 1891863569 05    MEDICAID             <NA>                   85000124G  GA   \n#> 38 1871816918 05    MEDICAID             <NA>                   003109531A GA   \n#> 39 1992710610 05    MEDICAID             <NA>                   300033792A GA   \n#> 40 1992710610 01    Other (non-Medicare) clinic rendering       367607289A GA   \n#> 41 1992710610 01    Other (non-Medicare) Medicare ID            DG2920     GA   \n#> 42 1497760243 01    Other (non-Medicare) Clinic rendering numb… 367607289B GA   \n#> 43 1497760243 05    MEDICAID             <NA>                   540960632A GA   \n#> 44 1497760243 01    Other (non-Medicare) Medicare ID            CH7677     GA   \n#> 45 1982631321 05    MEDICAID             <NA>                   000750274A GA   \n#> 46 1578682696 01    Other (non-Medicare) RHC NUMBER             11-8516    GA   \n#> 47 1700392438 05    MEDICAID             <NA>                   003213614A GA\n```\n\n\n:::\n\n```{.r .cell-code}\nrhc_nppes |> \n  slt(number, other_names) |> \n  unnest(other_names) |> \n  print(n = 100)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> # A tibble: 76 × 4\n#>    number     organization_name                                   type     code \n#>    <chr>      <chr>                                               <chr>    <chr>\n#>  1 1174104657 ACCESS MEDICAL CLINIC                               Doing B… 3    \n#>  2 1821017831 BACON COUNTY RURAL HEALTH CLINIC                    Doing B… 3    \n#>  3 1558898882 NICHOLLS FAMILY HEALTHCARE                          Doing B… 3    \n#>  4 1750339511 CARROLL CO PRIMARY HEALTH CARE                      Doing B… 3    \n#>  5 1417906348 FRANKLIN CLINIC                                     Doing B… 3    \n#>  6 1538117932 CARROLL COUNTY PRIMARY HEALTH CARE                  Doing B… 3    \n#>  7 1639211956 COFFEE REGIONAL FIRST CARE                          Doing B… 3    \n#>  8 1881758753 COLQUITT REGIONAL PRIMARY CARE CLINIC               Doing B… 3    \n#>  9 1790992352 WARWICK HEALTH CARE CLINIC                          Doing B… 3    \n#> 10 1376750976 CRISP REGIONAL CONVENIENT CARE                      Doing B… 3    \n#> 11 1427333095 DAHLONEGA PEDIATRICS                                Doing B… 3    \n#> 12 1821662008 DMC INTERNAL MEDICINE AND FAMILY HEALTH             Doing B… 3    \n#> 13 1821662008 DMC INTERNAL AND FAMILY MEDICINE CLINIC             Doing B… 3    \n#> 14 1922672120 DMC PRIMARY CARE                                    Doing B… 3    \n#> 15 1255948717 EASTMAN FAMILY PRACTICE                             Doing B… 3    \n#> 16 1811020407 EFFINGHAM FAMILY MEDICINE AT GOSHEN                 Doing B… 3    \n#> 17 1750686382 EFFINGHAM FAMILY MEDICINE AT TWENTY-ONE             Doing B… 3    \n#> 18 1700237633 ELLIJAY URGENT CARE & FAMILY PRACTICE               Doing B… 3    \n#> 19 1063832202 RAY MEDICAL CLINIC                                  Doing B… 3    \n#> 20 1437577350 EMANUEL FAMILY MEDICAL CLINIC                       Doing B… 3    \n#> 21 1366784415 SWAINSBORO INTERNAL MEDICINE                        Doing B… 3    \n#> 22 1912319997 TWIN CITY FAMILY MEDICAL CLINIC                     Doing B… 3    \n#> 23 1538586243 PORTER FAMILY MEDICAL CLINIC                        Doing B… 3    \n#> 24 1790088169 CANDLER MEDICAL GROUP RHC                           Doing B… 3    \n#> 25 1912379082 JEFF DAVIS FAMILY MEDICAL GROUP                     Doing B… 3    \n#> 26 1699782037 PHYSICIANS HEALTH GROUP WADLEY                      Doing B… 3    \n#> 27 1215943915 PHYSICIANS' HEALTH GROUP                            Doing B… 3    \n#> 28 1801801543 WRENS PHYSICIANS' HEALTH GROUP                      Doing B… 3    \n#> 29 1366472003 THE CAMILLA PEDIATRIC CENTER                        Doing B… 3    \n#> 30 1922211515 MEDICAL GROUP OF MITCHELL COUNTY                    Doing B… 3    \n#> 31 1881960151 ARCHBOLD - PELHAM PRIMARY CARE CLINIC               Doing B… 3    \n#> 32 1801128863 COMMUNITY MEDICAL ASSOCIATES OF LINCOLNTON          Doing B… 3    \n#> 33 1023332970 COMMUNITY MEDICAL ASSOCIATES OF WASHINGTON          Doing B… 3    \n#> 34 1649670894 IRWIN COUNTY HOSPITAL AUTHORITY                     Former … 4    \n#> 35 1649670894 WILLACOOCHEE CLINIC                                 Doing B… 3    \n#> 36 1912430224 LIFEBRITE FAMILY MEDICAL OF EARLY                   Doing B… 3    \n#> 37 1063459899 MEDICAL ASSOCIATES                                  Doing B… 3    \n#> 38 1851334015 NORTH JEFFERSON MEDICAL CENTER                      Doing B… 3    \n#> 39 1467602482 CHI MEMORIAL FAMILY PRACTICE ASSOCIATES - TRENTON   Doing B… 3    \n#> 40 1760632780 CHI MEMORIAL FAMILY PRACTICE ASSOCIATES - LAFAYETTE Doing B… 3    \n#> 41 1912564618 WARM SPRINGS MEDICAL CENTER                         Doing B… 3    \n#> 42 1376778001 PHOEBE SUMTER ELLAVILLE CLINIC                      Doing B… 3    \n#> 43 1891770764 PHOEBE WORTH FAMILY MEDICINE                        Doing B… 3    \n#> 44 1659700763 FLINT RIVER RURAL HEALTH CLINIC - OGLETHORPE        Doing B… 3    \n#> 45 1053802553 PRESTON FAMILY MEDICINE                             Doing B… 3    \n#> 46 1386339141 MOUNTAIN LAKES PHYSICIANS GROUP                     Doing B… 3    \n#> 47 1841432044 OPTIM PRIMARY CARE - SYLVANIA                       Doing B… 3    \n#> 48 1033428214 OPTIM PRIMARY CARE MILLEN                           Doing B… 3    \n#> 49 1649853862 SCHPG-PRIMARY CARE                                  Doing B… 3    \n#> 50 1285893818 OPTIM PRIMARY CARE-REIDSVILLE                       Doing B… 3    \n#> 51 1972762508 OPTIM PRIMARY CARE- GLENNVILLE                      Doing B… 3    \n#> 52 1285132415 OPTIM PRIMARY CARE METTER                           Doing B… 3    \n#> 53 1568713873 TAYLOR PHYSICIANS PRACTICE # 3                      Doing B… 3    \n#> 54 1720227895 APPLING PEDIATRICS                                  Doing B… 3    \n#> 55 1073752143 APPLING MEDICAL GROUP                               Doing B… 3    \n#> 56 1255570321 SOUTH GEORGIA MEDICAL ASSOCIATES                    Doing B… 3    \n#> 57 1740778828 INTERNAL MEDICINE AND GERIATRICS-RHC                Doing B… 3    \n#> 58 1740778828 HABERSHAM MEDICAL GROUP                             Doing B… 3    \n#> 59 1528110103 MILLER COUNTY MEDICAL CENTER                        Doing B… 3    \n#> 60 1235227752 ROBERT E JENNINGS MEDICAL CLINIC                    Doing B… 3    \n#> 61 1275775314 ATRIUM HEALTH NAVICENT PRIMARY CARE FORT VALLEY     Doing B… 3    \n#> 62 1275775314 VALLEY MEDICAL CENTER                               Doing B… 3    \n#> 63 1871816918 SOUTHWELL MEDICAL ADEL PRIMARY CARE                 Doing B… 3    \n#> 64 1871816918 COOK PRIMARY CARE                                   Doing B… 3    \n#> 65 1487284956 SOUTHWELL MEDICAL SYLVESTER PRIMARY CARE            Doing B… 3    \n#> 66 1861022329 SOUTHWELL MEDICAL CLINIC                            Doing B… 3    \n#> 67 1063042562 SOUTHWELL MEDICAL ASHBURN PRIMARY CARE              Doing B… 3    \n#> 68 1588294045 SOUTHWELL MEDICAL NASHVILLE PRIMARY CARE            Doing B… 3    \n#> 69 1649800111 SOUTHWELL MEDICAL COMMUNITY HEALTH CENTER           Doing B… 3    \n#> 70 1508801416 BUCHANAN MEDICAL CLINIC                             Doing B… 3    \n#> 71 1992710610 PRIMARY CARE OF BREMEN                              Doing B… 3    \n#> 72 1982631321 WEST CARROLL FAMILY HEALTHCARE                      Doing B… 3    \n#> 73 1578682696 UNION GENERAL FAMILY MEDICINE                       Doing B… 3    \n#> 74 1427384353 CHATUGE MEDICAL GROUP                               Other N… 5    \n#> 75 1700392438 UPSON REGIONAL MEDICAL CENTER                       Doing B… 3    \n#> 76 1174024665 C/O HOSPITAL AUTHORITY OF WASHINGTON COUNTY         Other N… 5\n```\n\n\n:::\n\n```{.r .cell-code}\nrhc_nppes |> \n  slt(number, practiceLocations) |> \n  unnest_wider(practiceLocations) |> \n  sbt(!is.na(state)) |> \n  print(n = 100)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> # A tibble: 1 × 11\n#>   number  country_code country_name address_purpose address_type address_1 city \n#>   <chr>   <chr>        <chr>        <chr>           <chr>        <chr>     <chr>\n#> 1 187181… US           United Stat… LOCATION        DOM          308 N PA… ADEL \n#> # ℹ 4 more variables: state <chr>, postal_code <chr>, telephone_number <chr>,\n#> #   fax_number <chr>\n```\n\n\n:::\n:::\n\n## Geocode with {tidygeocoder}\n\n::: {.cell}\n\n```{.r .cell-code}\ngeo_census <- tidygeocoder::geocode(\n  rhc_enr,\n  street = address,\n  city    = city,\n  state   = state,\n  postalcode = zip,\n  method = \"census\", \n  full_results = TRUE)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Passing 84 addresses to the US Census batch geocoder\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Query completed in: 1 seconds\n```\n\n\n:::\n\n```{.r .cell-code}\ngeo_census\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> # A tibble: 85 × 26\n#>    npi    has_mult_npi ccn   pac   enid  enid_state org_name dba_name inc_date  \n#>    <chr>         <int> <chr> <chr> <chr> <chr>      <chr>    <chr>    <date>    \n#>  1 16397…            0 1189… 2961… O202… GA         ACCESS … <NA>     2020-07-29\n#>  2 11741…            0 1189… 2961… O202… GA         ACCESS … <NA>     2021-01-11\n#>  3 15681…            0 1189… 2961… O202… GA         ACCESS … <NA>     2020-07-29\n#>  4 18210…            1 1134… 1850… O200… GA         BACON C… BACON C… 1995-06-15\n#>  5 15588…            0 1185… 1850… O201… GA         BACON C… NICHOLL… 1995-06-15\n#>  6 17503…            0 1138… 2264… O200… GA         BOWDON-… CARROLL… 1980-10-09\n#>  7 14179…            0 1138… 2264… O200… GA         BOWDON-… FRANLKI… 1980-10-09\n#>  8 15381…            0 1138… 2264… O201… GA         BOWDON-… CARROLL… 1980-10-09\n#>  9 18519…            0 1185… 3476… O202… GA         BURKE H… BURKE M… NA        \n#> 10 16392…            0 1134… 4587… O201… GA         COFFEE … COFFEE … NA        \n#> # ℹ 75 more rows\n#> # ℹ 17 more variables: inc_state <chr>, org_type <chr>, org_type_2 <chr>,\n#> #   proprietary_nonprofit <chr>, address <chr>, city <chr>, state <chr>,\n#> #   zip <chr>, lat <dbl>, long <dbl>, id <int>, input_address <chr>,\n#> #   match_indicator <chr>, match_type <chr>, matched_address <chr>,\n#> #   tiger_line_id <int>, tiger_side <chr>\n```\n\n\n:::\n\n```{.r .cell-code}\ngeo_arcgis <- tidygeocoder::geocode(\n  rhc_enr,\n  street = address,\n  city    = city,\n  state   = state,\n  postalcode = zip,\n  method = \"arcgis\", \n  full_results = TRUE)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Passing 84 addresses to the ArcGIS single address geocoder\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n#> Query completed in: 35.6 seconds\n```\n\n\n:::\n\n```{.r .cell-code}\ngeo_arcgis\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> # A tibble: 85 × 87\n#>    npi    has_mult_npi ccn   pac   enid  enid_state org_name dba_name inc_date  \n#>    <chr>         <int> <chr> <chr> <chr> <chr>      <chr>    <chr>    <date>    \n#>  1 16397…            0 1189… 2961… O202… GA         ACCESS … <NA>     2020-07-29\n#>  2 11741…            0 1189… 2961… O202… GA         ACCESS … <NA>     2021-01-11\n#>  3 15681…            0 1189… 2961… O202… GA         ACCESS … <NA>     2020-07-29\n#>  4 18210…            1 1134… 1850… O200… GA         BACON C… BACON C… 1995-06-15\n#>  5 15588…            0 1185… 1850… O201… GA         BACON C… NICHOLL… 1995-06-15\n#>  6 17503…            0 1138… 2264… O200… GA         BOWDON-… CARROLL… 1980-10-09\n#>  7 14179…            0 1138… 2264… O200… GA         BOWDON-… FRANLKI… 1980-10-09\n#>  8 15381…            0 1138… 2264… O201… GA         BOWDON-… CARROLL… 1980-10-09\n#>  9 18519…            0 1185… 3476… O202… GA         BURKE H… BURKE M… NA        \n#> 10 16392…            0 1134… 4587… O201… GA         COFFEE … COFFEE … NA        \n#> # ℹ 75 more rows\n#> # ℹ 78 more variables: inc_state <chr>, org_type <chr>, org_type_2 <chr>,\n#> #   proprietary_nonprofit <chr>, address <chr>, city <chr>, state <chr>,\n#> #   zip <chr>, lat <dbl>, long <dbl>, arcgis_address <chr>, score <dbl>,\n#> #   location.x <dbl>, location.y <dbl>, attributes.Loc_name <chr>,\n#> #   attributes.Status <chr>, attributes.Score <dbl>,\n#> #   attributes.Match_addr <chr>, attributes.LongLabel <chr>, …\n```\n\n\n:::\n:::\n\n## Retrieve Georgia counties shapefile from {tigris}\n\n::: {.cell}\n\n```{.r .cell-code}\ntig_cnt <- tigris::counties(\n  state = \"GA\",\n  year = 2022,\n  progress_bar = FALSE)\n\ntig_cnt\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> Simple feature collection with 159 features and 17 fields\n#> Geometry type: MULTIPOLYGON\n#> Dimension:     XY\n#> Bounding box:  xmin: -85.6 ymin: 30.4 xmax: -80.8 ymax: 35\n#> Geodetic CRS:  NAD83\n#> First 10 features:\n#>     STATEFP COUNTYFP COUNTYNS GEOID     NAME        NAMELSAD LSAD CLASSFP MTFCC\n#> 16       13      189 00348794 13189 McDuffie McDuffie County   06      H1 G4020\n#> 53       13      025 00351605 13025 Brantley Brantley County   06      H1 G4020\n#> 54       13      171 00326713 13171    Lamar    Lamar County   06      H1 G4020\n#> 83       13      115 00353665 13115    Floyd    Floyd County   06      H1 G4020\n#> 101      13      273 00352238 13273  Terrell  Terrell County   06      H1 G4020\n#> 102      13      063 01672399 13063  Clayton  Clayton County   06      H1 G4020\n#> 105      13      073 00348865 13073 Columbia Columbia County   06      H1 G4020\n#> 126      13      193 00346957 13193    Macon    Macon County   06      H1 G4020\n#> 146      13      049 00357747 13049 Charlton Charlton County   06      H1 G4020\n#> 147      13      233 00343585 13233     Polk     Polk County   06      H1 G4020\n#>     CSAFP CBSAFP METDIVFP FUNCSTAT      ALAND   AWATER    INTPTLAT     INTPTLON\n#> 16   <NA>   <NA>     <NA>        A  666591525 23112523 +33.4806126 -082.4795333\n#> 53   <NA>   <NA>     <NA>        A 1147972258 10291563 +31.1973339 -081.9829779\n#> 54   <NA>   <NA>     <NA>        A  475264405  6044329 +33.0744405 -084.1466893\n#> 83   <NA>   <NA>     <NA>        A 1320431515 22387093 +34.2636901 -085.2136849\n#> 101  <NA>   <NA>     <NA>        A  869695791  4951325 +31.7771909 -084.4394464\n#> 102  <NA>   <NA>     <NA>        A  367145192  6928044 +33.5516027 -084.4128678\n#> 105  <NA>   <NA>     <NA>        A  751598754 45345677 +33.5520746 -082.2496077\n#> 126  <NA>   <NA>     <NA>        A 1037709945 13841916 +32.3626859 -084.0512306\n#> 146  <NA>   <NA>     <NA>        A 2020415648  5963237 +30.7799036 -082.1396442\n#> 147  <NA>   <NA>     <NA>        A  803775591  4664760 +33.9960153 -085.1883384\n#>                           geometry\n#> 16  MULTIPOLYGON (((-82.6 33.6,...\n#> 53  MULTIPOLYGON (((-81.9 31.1,...\n#> 54  MULTIPOLYGON (((-84.2 33.1,...\n#> 83  MULTIPOLYGON (((-85 34.3, -...\n#> 101 MULTIPOLYGON (((-84.3 31.7,...\n#> 102 MULTIPOLYGON (((-84.5 33.6,...\n#> 105 MULTIPOLYGON (((-82.4 33.6,...\n#> 126 MULTIPOLYGON (((-83.8 32.4,...\n#> 146 MULTIPOLYGON (((-82.4 30.8,...\n#> 147 MULTIPOLYGON (((-85.2 33.9,...\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(tig_cnt)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>    STATEFP            COUNTYFP           COUNTYNS            GEOID          \n#>  Length:159         Length:159         Length:159         Length:159        \n#>  Class :character   Class :character   Class :character   Class :character  \n#>  Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n#>                                                                             \n#>                                                                             \n#>                                                                             \n#>      NAME             NAMELSAD             LSAD             CLASSFP         \n#>  Length:159         Length:159         Length:159         Length:159        \n#>  Class :character   Class :character   Class :character   Class :character  \n#>  Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n#>                                                                             \n#>                                                                             \n#>                                                                             \n#>     MTFCC              CSAFP              CBSAFP            METDIVFP        \n#>  Length:159         Length:159         Length:159         Length:159        \n#>  Class :character   Class :character   Class :character   Class :character  \n#>  Mode  :character   Mode  :character   Mode  :character   Mode  :character  \n#>                                                                             \n#>                                                                             \n#>                                                                             \n#>    FUNCSTAT             ALAND                AWATER            INTPTLAT        \n#>  Length:159         Min.   : 308985572   Min.   :   488463   Length:159        \n#>  Class :character   1st Qu.: 645741035   1st Qu.:  6553565   Class :character  \n#>  Mode  :character   Median : 887636774   Median : 11818093   Mode  :character  \n#>                     Mean   : 940165210   Mean   : 27790668                     \n#>                     3rd Qu.:1151923513   3rd Qu.: 19959364                     \n#>                     Max.   :2329020700   Max.   :509854701                     \n#>    INTPTLON                  geometry  \n#>  Length:159         MULTIPOLYGON :159  \n#>  Class :character   epsg:4269    :  0  \n#>  Mode  :character   +proj=long...:  0  \n#>                                        \n#>                                        \n#> \n```\n\n\n:::\n\n```{.r .cell-code}\nsf_cnt <- ms_simplify(tig_cnt)\n\nsf_cnt$mid <- st_centroid(sf_cnt$geometry)\n```\n:::\n\n\n## Map with {ggplot}\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(sf_cnt) +\n  geom_sf(\n    fill = \"skyblue\",\n    colour = \"white\",\n    alpha = 0.5) +\n  geom_sf_text(\n    aes(geometry = geometry, \n        label = NAME),\n    size = 3.5,\n    check_overlap = TRUE) +\n  geom_jitter(\n    data = geo_census,\n    mapping = aes(long, lat),\n    fill = \"yellow\",\n    color = \"darkred\",\n    alpha = 0.75,\n    size = 4,\n    shape = 21,\n    stroke = 1) +\n  theme_void()\n```\n\n::: {.cell-output-display}\n![](demo_geo_files/figure-html/unnamed-chunk-8-1.png){width=100%}\n:::\n:::\n\n",
    "supporting": [
      "demo_geo_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}