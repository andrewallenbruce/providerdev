{
  "hash": "e229318489299f6ebc9ce726f5cb011b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"`providers()`\"\neditor_options: \n   chunk_output_type: console\n---\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<a href=\"https://andrewallenbruce.github.io/provider/reference/providers.html\" class=\"btn btn-outline-secondary\" role=\"button\" target=\"_blank\">\n<i class=\"bi bi-box-arrow-up-right\"></i>\nDocumentation\n</a>\n<a href=\"https://github.com/andrewallenbruce/provider/blob/main/R/providers.R\" class=\"btn btn-outline-secondary\" role=\"button\" target=\"_blank\">\n<i class=\"bi bi-box-arrow-up-right\"></i>\nSource\n</a>\n```\n\n:::\n:::\n\n   * Base URL: `https://data.cms.gov/data-api/v1/`\n   * Identifier: `2457ea29-fc82-48b0-86ec-3b0755de7515`\n\n## Catalog\n\n::: {.cell}\n\n```{.r .cell-code}\npublic_catalog <- \\() {\n  \n  x <- RcppSimdJson::fload(\"https://data.cms.gov/data.json\")\n  \n  collapse::qTBL(x[[\"dataset\"]]) |>\n    collapse::fmutate(\n      bureauCode   = delist(bureauCode),\n      language     = delist(language),\n      programCode  = delist(programCode),\n      references   = delist(references),\n      theme        = flatten_column(theme),\n      keyword      = flatten_column(keyword)) |>\n    collapse::frename(remove_at_symbol)\n}\n\npublic <- public_catalog()\n\npublic\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 139 × 22\n   type       accessLevel accrualPeriodicity bureauCode contactPoint describedBy\n   <chr>      <chr>       <chr>              <chr>      <list>       <chr>      \n 1 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 2 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 3 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 4 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 5 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 6 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 7 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 8 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n 9 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n10 dcat:Data… public      R/P1Y              009:38     <named list> https://da…\n# ℹ 129 more rows\n# ℹ 16 more variables: dataQuality <lgl>, description <chr>,\n#   distribution <list>, identifier <chr>, keyword <chr>, landingPage <chr>,\n#   language <chr>, license <chr>, modified <chr>, programCode <chr>,\n#   publisher <list>, references <chr>, temporal <chr>, theme <chr>,\n#   title <chr>, describedByType <chr>\n```\n\n\n:::\n:::\n\n## Dataset\n\n::: {.cell}\n\n```{.r .cell-code}\ndataset <- \\(catalog, search) {\n  collapse::fsubset(\n    catalog, \n    providertwo::sf_detect(\n      title, \n      search\n      )\n    )\n}\n\nffs <- dataset(public, \"Fee-For-Service\")\n\nffs |> purse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- $type               c1  dcat:Dataset                                      ...\n- $accessLevel        c1  public                                            ...\n- $accrualPeriodicity c1  R/P3M                                             ...\n- $bureauCode         c1  009:38                                            ...\n- $contactPoint       L1  list(list(\"@type\" = \"vcard:Contact\", fn = \"Provid ...\n- $describedBy        c1  https://data.cms.gov/resources/medicare-fee-for-s ...\n- $dataQuality        l1  T                                                 ...\n- $description        c1  The Medicare Fee-For-Service Public Provider Enro ...\n- $distribution       L1  list(structure(list(\"@type\" = c(\"dcat:Distributio ...\n- $identifier         c1  https://data.cms.gov/data-api/v1/dataset/2457ea29 ...\n- $keyword            c1  Medicare, Original Medicare, Provider Enrollment  ...\n- $landingPage        c1  https://data.cms.gov/provider-characteristics/med ...\n- $language           c1  en-US                                             ...\n- $license            c1  https://www.usa.gov/government-works              ...\n- $modified           c1  2024-10-16                                        ...\n- $programCode        c1  009:000                                           ...\n- $publisher          L1  list(list(\"@type\" = \"org:Organization\", name = \"C ...\n- $references         c1  https://data.cms.gov/resources/fee-for-service-pu ...\n- $temporal           c1  2023-01-01/2024-09-30                             ...\n- $theme              c1  Medicare                                          ...\n- $title              c1  Medicare Fee-For-Service  Public Provider Enrollm ...\n- $describedByType    c1  NA                                                ...\n```\n\n\n:::\n:::\n\n\n## Distribution\n\n::: {.cell}\n\n```{.r .cell-code}\ndistribution <- \\(dataset, search) {\n  \n  x <- collapse::fsubset(\n    dataset[c(\"title\", \"distribution\")], \n    providertwo::sf_detect(title, search))\n  \n  collapse::qTBL(x[[\"distribution\"]][[1]])\n}\n\ndistribution(ffs, \"Fee-For-Service\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 15 × 10\n   `@type`     format accessURL resourcesAPI description title modified temporal\n   <chr>       <chr>  <chr>     <chr>        <chr>       <chr> <chr>    <chr>   \n 1 dcat:Distr… API    https://… https://dat… latest      Medi… 2024-10… 2024-07…\n 2 dcat:Distr… <NA>   <NA>      https://dat… <NA>        Medi… 2024-10… 2024-07…\n 3 dcat:Distr… API    https://… https://dat… <NA>        Medi… 2024-10… 2024-07…\n 4 dcat:Distr… <NA>   <NA>      https://dat… <NA>        Medi… 2024-07… 2024-04…\n 5 dcat:Distr… API    https://… https://dat… <NA>        Medi… 2024-07… 2024-04…\n 6 dcat:Distr… <NA>   <NA>      https://dat… <NA>        Medi… 2024-04… 2024-01…\n 7 dcat:Distr… API    https://… https://dat… <NA>        Medi… 2024-04… 2024-01…\n 8 dcat:Distr… <NA>   <NA>      https://dat… <NA>        Medi… 2024-01… 2023-10…\n 9 dcat:Distr… API    https://… https://dat… <NA>        Medi… 2024-01… 2023-10…\n10 dcat:Distr… <NA>   <NA>      https://dat… <NA>        Medi… 2023-10… 2023-07…\n11 dcat:Distr… API    https://… https://dat… <NA>        Medi… 2023-10… 2023-07…\n12 dcat:Distr… <NA>   <NA>      https://dat… <NA>        Medi… 2023-09… 2023-04…\n13 dcat:Distr… API    https://… https://dat… <NA>        Medi… 2023-09… 2023-04…\n14 dcat:Distr… <NA>   <NA>      https://dat… <NA>        Medi… 2023-04… 2023-01…\n15 dcat:Distr… API    https://… https://dat… <NA>        Medi… 2023-04… 2023-01…\n# ℹ 2 more variables: downloadURL <chr>, mediaType <chr>\n```\n\n\n:::\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncollapse::fsubset(\n    distribution(ffs, \"Fee-For-Service\"), \n    description %==% \"latest\") |> \n  purse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- $@type        c1  dcat:Distribution                                       ...\n- $format       c1  API                                                     ...\n- $accessURL    c1  https://data.cms.gov/data-api/v1/dataset/2457ea29-fc82- ...\n- $resourcesAPI c1  https://data.cms.gov/data-api/v1/dataset-resources/2457 ...\n- $description  c1  latest                                                  ...\n- $title        c1  Medicare Fee-For-Service Public Provider Enrollment : 2 ...\n- $modified     c1  2024-10-16                                              ...\n- $temporal     c1  2024-07-01/2024-09-30                                   ...\n- $downloadURL  c1  NA                                                      ...\n- $mediaType    c1  NA                                                      ...\n```\n\n\n:::\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncollapse::fsubset(\n    distribution(ffs, \"Fee-For-Service\"), \n    format %==% \"API\") |> \n  purse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- $@type        c8  dcat:Distribution                                       ...\n- $format       c8  API                                                     ...\n- $accessURL    c8  https://data.cms.gov/data-api/v1/dataset/2457ea29-fc82- ...\n- $resourcesAPI c8  https://data.cms.gov/data-api/v1/dataset-resources/2457 ...\n- $description  c8  latest                                                  ...\n- $title        c8  Medicare Fee-For-Service Public Provider Enrollment : 2 ...\n- $modified     c8  2024-10-16                                              ...\n- $temporal     c8  2024-07-01/2024-09-30                                   ...\n- $downloadURL  c8  NA                                                      ...\n- $mediaType    c8  NA                                                      ...\n```\n\n\n:::\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncollapse::fsubset(\n    distribution(ffs, \"Fee-For-Service\"), \n    mediaType %==% \"text/csv\") |> \n  purse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n- $@type        c7  dcat:Distribution                                       ...\n- $format       c7  NA                                                      ...\n- $accessURL    c7  NA                                                      ...\n- $resourcesAPI c7  https://data.cms.gov/data-api/v1/dataset-resources/5731 ...\n- $description  c7  NA                                                      ...\n- $title        c7  Medicare Fee-For-Service Public Provider Enrollment : 2 ...\n- $modified     c7  2024-10-16                                              ...\n- $temporal     c7  2024-07-01/2024-09-30                                   ...\n- $downloadURL  c7  https://data.cms.gov/sites/default/files/2024-10/8e1bba ...\n- $mediaType    c7  text/csv                                                ...\n```\n\n\n:::\n:::\n\n## URLS\n\n::: {.cell}\n\n```{.r .cell-code}\nlist(\n  dataset = provider_dataset, \n  latest = provider_latest,\n  api = provider_api,\n  csv = provider_csv\n  )\n```\n:::\n\n\n## No. of Results\n\n::: {.cell}\n\n```{.r .cell-code}\nrequest(urls$base) |> \n  req_url_path_append(urls$identifier) |> \n  req_url_path_append(\"stats\") |> \n  req_perform() |> \n  resp_body_json(simplifyVector = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nquery <- glue::glue(\n  '\n  \"filter[fID{fID}][path]\" = \"{PATH}\",\n  \"filter[fID{fID}][operator]\" = \"{OPERATOR}\",\n  \"filter[fID{fID}][value]\" = \"{VALUE}\"\n  ', \n  fID = 1:2, \n  PATH = c(\"STATE_CD\", \"LAST_NAME\"), \n  OPERATOR = \"=\",\n  VALUE = c(\"GA\", \"SMITH\")\n  ) |> \n  glue::glue_collapse(sep = \",\\n\")\n\nquery <- glue::glue('c({query})') |> \n  rlang::parse_expr() |> \n  rlang::eval_bare()\n\nrequest(urls$base) |> \n  req_url_path_append(urls$identifier) |> \n  req_url_path_append(\"stats\") |> \n  req_url_query(!!!query) |> \n  req_perform() |> \n  resp_body_json(simplifyVector = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nresp <- request(urls$base) |> \n  req_url_path_append(urls$identifier) |> \n  req_url_query(!!!query, size = 5000) |> \n  req_perform()\n\nresp <- RcppSimdJson::fparse(httr2::resp_body_string(resp))\n\ncollapse::qTBL(resp[[\"data\"]]) |>\n  setNames(c(\"NPI\", \"PECOS_ASCT_CNTL_ID\", \"ENRLMT_ID\", \n             \"PROVIDER_TYPE_CD\", \"PROVIDER_TYPE_DESC\", \n             \"STATE_CD\", \"FIRST_NAME\", \"MDL_NAME\", \n             \"LAST_NAME\", \"ORG_NAME\", \"GNDR_SW\"))\n```\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nformat_syntax <- \\(name, value) {\n  setNames(\n    value, \n    paste0(\n      name, \n      \"[id-\", \n      seq_along(value), \n      \"][condition][value]\"))\n}\n\nformat_syntax(\"filter\", c(\"GA\", \"NY\"))\n\n\n# query_syntax <- c(\n#   \"filter[STATE_CD]\" = \"GA\",\n#   \"filter[LAST_NAME]\" = \"SMITH\"\n#   )\n```\n:::\n\n--------------------------------------------------------------------------------\n",
    "supporting": [
      "end_providers_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}