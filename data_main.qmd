---
title: "Main"
editor_options: 
   chunk_output_type: console
---

```{r setup}
#| echo: false
#| message: false
#| warning: false
source("_common.R")
```

## Catalog

```{r}
#| label: catalog
main <- main_data_rcpp()

main
```

### S7 Class

```{r}
Catalog <- new_class(
  name = "Catalog",
  properties = list(
    context = new_property(class_character, default = "https://project-open-data.cio.gov/v1.1/schema/catalog.jsonld"),
    id = new_property(class_character, default = "https://data.cms.gov/data.json"),
    type = new_property(class_character, default = "dcat:Catalog"),
    conformsTo = new_property(class_character, default = "https://project-open-data.cio.gov/v1.1/schema"),
    describedBy = new_property(class_character, default = "https://project-open-data.cio.gov/v1.1/schema/catalog.json"),
    dataset = class_data.frame
  )
)

Catalog()
```

### Dataset

```{r}
#| label: dataset
main[["dataset"]] |> 
  tidyr::unnest_wider(contactPoint, names_sep = "_") |>
  tidyr::unnest_wider(publisher, names_sep = "_") |> 
  collapse::frename(remove_at_symbol) |> 
  remove_all_na() |> 
  purse()
```

### Distribution: Latest

```{r}
#| label: distribution_latest
main[["distribution_latest"]]
```

### Distribution: API

```{r}
#| label: distribution_api
main[["distribution_api"]]
```

### Distribution: CSV

```{r}
#| label: distribution_csv
main[["distribution_csv"]]
```

